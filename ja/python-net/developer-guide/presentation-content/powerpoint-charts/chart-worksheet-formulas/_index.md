---
title: "Python を使用したプレゼンテーションでのチャート ワークシート数式の適用"
linktitle: "ワークシート数式"
type: docs
weight: 70
url: /ja/python-net/chart-worksheet-formulas/
keywords:
- "チャート スプレッドシート"
- "チャート ワークシート"
- "チャート 数式"
- "ワークシート 数式"
- "スプレッドシート 数式"
- "データ ソース"
- "論理定数"
- "数値定数"
- "文字列定数"
- "エラー定数"
- "算術定数"
- "比較演算子"
- "A1 形式"
- "R1C1 形式"
- "組み込み関数"
- "PowerPoint"
- "OpenDocument"
- "プレゼンテーション"
- "Python"
- "Aspose.Slides"
description: "Aspose.Slides for Python（.NET）で Excel 形式の数式をチャート ワークシートに適用し、PPT、PPTX、ODP ファイル全体でレポートを自動化します。"
---

## **プレゼンテーションにおけるチャート スプレッドシート数式について**
**チャート スプレッドシート**（またはチャート ワークシート）は、プレゼンテーション内のチャートのデータ ソースです。チャート スプレッドシートにはデータが含まれ、チャート上にグラフィカルに表示されます。PowerPoint でチャートを作成すると、そのチャートに関連付けられたワークシートも自動的に作成されます。チャート ワークシートは、折れ線グラフ、棒グラフ、サンバースト グラフ、円グラフなど、すべてのチャートタイプに対して作成されます。PowerPoint でチャート スプレッドシートを表示するには、チャートをダブルクリックしてください:

![todo:image_alt_text](chart-worksheet-formulas_1.png)

チャート スプレッドシートには、チャート要素の名前（カテゴリ名: *Category1*、シリーズ名）と、これらのカテゴリとシリーズに対応する数値データの表が含まれます。デフォルトでは、新しいチャートを作成すると、デフォルトデータがチャート スプレッドシートに設定されます。その後、ワークシート上でデータを手動で変更できます。

通常、チャートは複雑なデータ（例: 財務アナリスト、科学アナリスト）が対象で、セルは他のセルの値や動的データから計算されます。セルの値を手動で計算してハードコードすると、将来的に変更が困難になります。あるセルの値を変更すると、そのセルに依存するすべてのセルも更新が必要になります。さらに、表データは他の表のデータに依存することがあり、プレゼンテーションのデータ構造が複雑になり、簡単かつ柔軟に更新できる必要があります。

**プレゼンテーションのチャート スプレッドシート数式**は、チャート スプレッドシート データを自動的に計算・更新する式です。数式は特定のセルまたはセルの集合の計算ロジックを定義します。数式はセル参照、数学関数、論理演算子、算術演算子、変換関数、文字列定数などを使用した数学式または論理式です。数式はセルに書き込まれ、そのセルは単純な値を持ちません。数式は値を計算して返し、その結果がセルに割り当てられます。プレゼンテーションのチャート スプレッドシート数式は実質的に Excel の数式と同じで、同じ既定関数、演算子、定数がサポートされています。

[**Aspose.Slides** ](https://products.aspose.com/slides/python-net/) では、チャート スプレッドシートは  
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdata/) プロパティの  
[**IChartDataWorkbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdataworkbook/) 型で表されます。  
数式は [**formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) プロパティで割り当て・変更できます。  
Aspose.Slides がサポートする数式の機能は以下のとおりです。

- 論理定数
- 数値定数
- 文字列定数
- エラー定数
- 算術演算子
- 比較演算子
- A1 形式セル参照
- R1C1 形式セル参照
- 組み込み関数

通常、スプレッドシートは最後に計算された数式の結果を保持します。プレゼンテーションの読み込み後にチャート データが変更されていなければ、**IChartDataCell.Value** プロパティはそれらの値を返します。しかし、スプレッドシート データが変更された場合、**ChartDataCell.Value** プロパティを読み込むと、サポートされていない数式に対して **CellUnsupportedDataException** がスローされます。これは、数式が正常に解析されるとセルの依存関係が確定し、最後の値の正確性が保証されますが、数式が解析できない場合はセル値の正確性が保証できないためです。

## **プレゼンテーションにチャート スプレッドシート数式を追加する**
まず、[add_chart](https://reference.aspose.com/slides/python-net/aspose.slides/ishapecollection/) を使用して新しいプレゼンテーションの最初のスライドにサンプル データ付きのチャートを追加します。チャートのワークシートは自動的に作成され、次のプロパティでアクセスできます:

[**chart_data_workbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdata/) プロパティ:

```py
import aspose.slides.charts as charts
import aspose.slides as slides

with slides.Presentation() as presentation:
    chart = presentation.slides[0].shapes.add_chart(charts.ChartType.CLUSTERED_COLUMN, 150, 150, 500, 300)
    workbook = chart.chart_data.chart_data_workbook
    # ...
```

**Object** 型の **value** プロパティを使用してセルに値を書き込めます。これにより任意の型の値を設定可能です:

```py
    workbook.get_cell(0, "F2").value = -2.5
    workbook.get_cell(0, "G3").value = 6.3
    workbook.get_cell(0, "H4").value = 3
```

数式を書き込むには **formula** プロパティを使用します:

```py
    workbook.get_cell(0, "B2").formula = "F2+G3+H4+1"
```

*注*: **IChartDataCell.Formula** プロパティは A1 形式のセル参照を設定するために使用します。

R1C1 形式のセル参照を設定するには **r1c1_formula** プロパティを使用します:

```py
    workbook.get_cell(0, "C2").r1c1_formula = "R[1]C[4]/R[2]C[5]"
```

その後、[**calculate_formulas**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/chartdataworkbook/) メソッドでブック全体の数式を計算し、対応するセルの値を更新します:

```py
    workbook.calculate_formulas()
    print(workbook.get_cell(0, "B2").value) # 7.8
    print(workbook.get_cell(0, "C2").value) # 2.1
```

## **論理定数**
セル数式で *FALSE* および *TRUE* の論理定数を使用できます:

## **数値定数**
数式では整数や小数だけでなく、科学的表記も使用できます:

## **文字列定数**
文字列（リテラル）定数はそのまま使用され、変更されません。文字列定数には日付、テキスト、数値などが含まれます:

## **エラー定数**
数式で結果を計算できない場合、セルにはエラーコードが表示されます。主なエラー定数は次のとおりです:

- #DIV/0! - 数式がゼロ除算を試みた場合。
- #GETTING_DATA - セルの値がまだ計算中の場合に表示されることがあります。
- #N/A - 情報が不足または利用できない場合。原因例: 参照セルが空、余分なスペース文字、タイプミスなど。
- #NAME? - 特定のセルまたは数式オブジェクトが名前で見つからない場合。
- #NULL! - 数式内に誤った構文（例: (,) やコロン (:) の代わりにスペース）がある場合に発生。
- #NUM! - 数式内の数値が無効、桁数が多すぎる、または小さすぎるなど。
- #REF! - 無効なセル参照。
- #VALUE! - 期待された型と異なる値が設定された場合（例: 文字列が数値セルに設定された場合）。

## **算術演算子**
チャート ワークシート数式で使用できるすべての算術演算子は以下のとおりです:

|**演算子**|**意味**|**例**|
| :- | :- | :- |
|+ (プラス)|加算または単項プラス|2 + 3|
|- (マイナス)|減算または単項マイナス|2 - 3<br>-3|
|* (アスタリスク)|乗算|2 * 3|
|/ (スラッシュ)|除算|2 / 3|
|% (パーセント)|パーセンテージ|30%|
|^ (キャレット)|べき乗|2 ^ 3|

*注*: 計算順序を変更するには、先に計算したい部分を丸括弧で囲んでください。

## **比較演算子**
比較演算子を使用してセルの値を比較できます。比較結果は論理値 *TRUE* または *FALSE* です:

|**演算子**|**意味**|**例**|
| :- | :- | :- |
|= (イコール)|等しい|A2 = 3|
|<> (不等号)|等しくない|A2 <> 3|
|> (大なり)|より大きい|A2 > 3|
|>= (大なりイコール)|以上|A2 >= 3|
|< (小なり)|より小さい|A2 < 3|
|<= (小なりイコール)|以下|A2 <= 3|

## **A1 形式セル参照**
**A1 形式セル参照**は、列が文字（例: *A*）で行が数字（例: *1*）で表されるワークシートで使用されます。A1 形式は次のように指定できます:

|**参照タイプ**|**絶対参照**|**相対参照**|**混合参照**|
| :- | :- | :- | :- |
|セル|$A$2|A2|A$2、$A2|
|行|$2:$2|2:2|-|
|列|$A:$A|A:A|-|
|範囲|$A$2:$C$4|A2:C4|$A$2:C4、A$2:$C4|

以下は数式で A1 形式のセル参照を使用する例です:

## **R1C1 形式セル参照**
**R1C1 形式セル参照**は、行と列の両方が数値で表されるワークシートで使用されます。R1C1 形式は次のように指定できます:

|**参照タイプ**|**絶対参照**|**相対参照**|**混合参照**|
| :- | :- | :- | :- |
|セル|R2C3|R[2]C[3]|R2C[3]、R[2]C3|
|行|R2|R[2]|-|
|列|C3|C[3]|-|
|範囲|R2C3:R5C7|R[2]C[3]:R[5]C[7]|R2C3:R[5]C7、R[2]C3:R5C7|

以下は数式で R1C1 形式のセル参照を使用する例です:

## **組み込み関数**
数式で使用できる組み込み関数は以下のとおりです。これらは一般的に使用される操作を簡略化します。

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (1900 日付系統)
- DAYS
- FIND
- FINDB
- IF
- INDEX (参照形式)
- LOOKUP (ベクトル形式)
- MATCH (ベクトル形式)
- MAX
- SUM
- VLOOKUP

## **FAQ**

**数式付きチャートのデータ ソースとして外部 Excel ファイルは使用できますか？**

はい。Aspose.Slides は外部ブックを [チャートのデータ ソース](https://reference.aspose.com/slides/python-net/aspose.slides.charts/chartdatasourcetype/) としてサポートしており、プレゼンテーション外部の XLSX から数式を使用できます。

**チャート数式は同一ブック内のシート名でシートを参照できますか？**

はい。数式は標準的な Excel 参照モデルに従うため、同一ブック内または外部ブックの他シートを参照できます。外部参照の場合は、Excel の構文でパスとブック名を含めて指定してください。