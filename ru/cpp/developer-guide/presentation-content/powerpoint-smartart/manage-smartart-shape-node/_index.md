---
title: Управление узлом SmartArt
type: docs
weight: 30
url: /cpp/manage-smartart-shape-node/
---



## **Добавить узел SmartArt**
Aspose.Slides для C++ предоставил самый простой API для управления фигурами SmartArt самым простым способом. Следующий пример кода поможет добавить узел и дочерний узел внутри фигуры SmartArt.

- Создайте экземпляр класса [Presentation](https://reference.aspose.com/slides/net/aspose.slides/presentation) и загрузите презентацию с фигурой SmartArt.
- Получите ссылку на первый слайд, используя его индекс.
- Пройдите через каждую фигуру на первом слайде.
- Проверьте, является ли фигура типом SmartArt, и если это SmartArt, выполните приведение типа выбранной фигуры к SmartArt.
- Добавьте новый узел в коллекцию узлов фигуры SmartArt и задайте текст в TextFrame.
- Теперь добавьте дочерний узел в недавно добавленный узел SmartArt и задайте текст в TextFrame.
- Сохраните презентацию.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-AddNodes-AddNodes.cpp" >}}

## **Добавить узел SmartArt в конкретной позиции**
В следующем примере кода мы объяснили, как добавить дочерние узлы, относящиеся к соответствующим узлам фигуры SmartArt, в определенной позиции.

- Создайте экземпляр класса `Presentation`.
- Получите ссылку на первый слайд, используя его индекс.
- Добавьте фигуру типа StackedList на доступный слайд.
- Получите доступ к первому узлу в добавленной фигуре SmartArt.
- Теперь добавьте дочерний узел для выбранного узла на позиции 2 и задайте его текст.
- Сохраните презентацию.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-AddNodesSpecificPosition-AddNodesSpecificPosition.cpp" >}}


## **Получить доступ к узлу SmartArt**
Следующий пример кода поможет получить доступ к узлам внутри фигуры SmartArt. Обратите внимание, что вы не можете изменить тип компоновки (LayoutType) SmartArt, так как он является только для чтения и устанавливается только при добавлении фигуры SmartArt.

- Создайте экземпляр класса `Presentation` и загрузите презентацию с фигурой SmartArt.
- Получите ссылку на первый слайд, используя его индекс.
- Пройдите через каждую фигуру на первом слайде.
- Проверьте, является ли фигура типом SmartArt, и если это SmartArt, выполните приведение типа выбранной фигуры к SmartArt.
- Пройдите по всем узлам внутри фигуры SmartArt.
- Получите доступ и отобразите такие данные, как позиция узла SmartArt, уровень и текст.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-AccessSmartArt-AccessSmartArt.cpp" >}}

## **Получить доступ к дочернему узлу SmartArt**
Следующий пример кода поможет получить доступ к дочерним узлам, относящимся к соответствующим узлам фигуры SmartArt.

- Создайте экземпляр класса PresentationEx и загрузите презентацию с фигурой SmartArt.
- Получите ссылку на первый слайд, используя его индекс.
- Пройдите через каждую фигуру на первом слайде.
- Проверьте, является ли фигура типом SmartArt, и если это SmartArt, выполните приведение типа выбранной фигуры к SmartArtEx.
- Пройдите по всем узлам внутри фигуры SmartArt.
- Для каждого выбранного узла фигуры SmartArt пройдите по всем дочерним узлам внутри конкретного узла.
- Получите доступ и отобразите такие данные, как позиция дочернего узла, уровень и текст.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-AccessChildNodes-AccessChildNodes.cpp" >}}

## **Получить доступ к дочернему узлу SmartArt в конкретной позиции**
В этом примере мы научимся получать доступ к дочерним узлам в определенной позиции, относящимся к соответствующим узлам фигуры SmartArt.

- Создайте экземпляр класса `Presentation`.
- Получите ссылку на первый слайд, используя его индекс.
- Добавьте фигуру SmartArt типа StackedList.
- Получите доступ к добавленной фигуре SmartArt.
- Получите доступ к узлу с индексом 0 для полученной фигуры SmartArt.
- Теперь получите доступ к дочернему узлу на позиции 1 для полученного узла SmartArt, используя метод GetNodeByPosition().
- Получите доступ и отобразите такие данные, как позиция дочернего узла, уровень и текст.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-AccessChildNodeSpecificPosition-AccessChildNodeSpecificPosition.cpp" >}}

## **Удалить узел SmartArt**
В этом примере мы научимся удалять узлы внутри фигуры SmartArt.

- Создайте экземпляр класса `Presentation` и загрузите презентацию с фигурой SmartArt.
- Получите ссылку на первый слайд, используя его индекс.
- Пройдите через каждую фигуру на первом слайде.
- Проверьте, является ли фигура типом SmartArt, и если это SmartArt, выполните приведение типа выбранной фигуры к SmartArt.
- Проверьте, есть ли в SmartArt более 0 узлов.
- Выберите узел SmartArt, который необходимо удалить.
- Теперь удалите выбранный узел, используя метод RemoveNode(). Сохраните презентацию.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-RemoveNode-RemoveNode.cpp" >}}

## **Удалить узел SmartArt в конкретной позиции**
В этом примере мы научимся удалять узлы внутри фигуры SmartArt в конкретной позиции.

- Создайте экземпляр класса `Presentation` и загрузите презентацию с фигурой SmartArt.
- Получите ссылку на первый слайд, используя его индекс.
- Пройдите через каждую фигуру на первом слайде.
- Проверьте, является ли фигура типом SmartArt, и если это SmartArt, выполните приведение типа выбранной фигуры к SmartArt.
- Выберите узел фигуры SmartArt с индексом 0.
- Теперь проверьте, есть ли у выбранного узла SmartArt более 2 дочерних узлов.
- Теперь удалите узел на позиции 1, используя метод RemoveNodeByPosition(). Сохраните презентацию.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-RemoveNodeSpecificPosition-RemoveNodeSpecificPosition.cpp" >}}


## **Установить пользовательскую позицию для дочернего узла SmartArt**
Теперь Aspose.Slides для .NET поддерживает установку свойств X и Y для SmartArtShape. Код ниже показывает, как задать пользовательскую позицию, размер и вращение для SmartArtShape; также обратите внимание, что добавление новых узлов приводит к перерасчёту позиций и размеров всех узлов.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-CustomChildNodesInSmartArt-CustomChildNodesInSmartArt.cpp" >}}


## **Проверить узел-ассистент**
В следующем примере кода мы исследуем, как идентифицировать узлы-ассистенты в коллекции узлов SmartArt и изменять их.

- Создайте экземпляр класса PresentationEx и загрузите презентацию с фигурой SmartArt.
- Получите ссылку на второй слайд, используя его индекс.
- Пройдите через каждую фигуру на первом слайде.
- Проверьте, является ли фигура типом SmartArt, и если это SmartArt, выполните приведение типа выбранной фигуры к SmartArtEx.
- Пройдите по всем узлам внутри фигуры SmartArt и проверьте, являются ли они узлами-ассистентами.
- Измените статус узла-ассистента на обычный узел.
- Сохраните презентацию.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-AssistantNode-AssistantNode.cpp" >}}

## **Установить формат заливки узла**
Aspose.Slides для C++ позволяет добавлять пользовательские фигуры SmartArt и устанавливать их форматы заливки. Эта статья объясняет, как создать и получить доступ к фигурам SmartArt и установить их формат заливки с использованием Aspose.Slides для C++.

Пожалуйста, выполните следующие шаги:

- Создайте экземпляр класса `Presentation`.
- Получите ссылку на слайд, используя его индекс.
- Добавьте фигуру SmartArt, установив её тип компоновки.
- Установите FillFormat для узлов фигуры SmartArt.
- Запишите модифицированную презентацию в файл PPTX.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-FillFormatSmartArtShapeNode-FillFormatSmartArtShapeNode.cpp" >}}


## **Сгенерировать миниатюру дочернего узла SmartArt**
Разработчики могут сгенерировать миниатюру дочернего узла SmartArt, следуя приведённым ниже шагам:

1. Создайте экземпляр класса `Presentation`, представляющий файл PPTX.
1. Добавьте SmartArt.
1. Получите ссылку на узел, используя его индекс.
1. Получите изображение миниатюры.
1. Сохраните изображение миниатюры в любом желаемом формате изображения.

В следующем примере создаётся миниатюра дочернего узла SmartArt.

{{< gist "aspose-slides" "a690df625dc0b1fff869ab198affe7a4" "Examples-SlidesCPP-CreateSmartArtChildNoteThumbnail-CreateSmartArtChildNoteThumbnail.cpp" >}}