---
title: Рабочее решение для изменения размера диаграмм в PPTX
type: docs
weight: 40
url: /ru/java/working-solution-for-chart-resizing-in-pptx/
---

{{% alert color="primary" %}} 

Было замечено, что диаграммы Excel, встроенные как OLE в презентацию PowerPoint с помощью компонентов Aspose, изменяются в неизвестном масштабе после первой активации. Это поведение создает значительное визуальное различие презентации между состояниями до и после активации диаграммы. Команда Aspose с помощью команды Microsoft детально изучила эту проблему и нашла ее решение. В этой статье рассматриваются причины и решение данной проблемы.

{{% /alert %}} 
## **Предыстория**
В [предыдущей статье](/slides/ru/java/creating-excel-chart-and-embedding-it-in-presentation-as-ole-object/) мы объяснили, как создать диаграмму Excel с помощью Aspose.Cells для Java и далее встроить эту диаграмму в презентацию PowerPoint с помощью Aspose.Slides для Java. Чтобы учесть [проблему изменения объекта](/slides/ru/java/updating-ole-objects-automatically-using-ms-powerpoint-add-in/), мы назначили изображение диаграммы ОLE-объекту свойствам. В выходной презентации, когда мы дважды щелкаем по OLE-объекту, отображающему изображение диаграммы, активируется диаграмма Excel. Конечные пользователи могут внести любые желаемые изменения в фактической книге Excel, а затем вернуться к соответствующему слайду, щелкнув вне активной книги Excel. Размер OLE-объекта изменится, когда пользователь вернется к слайду. Фактор изменения размера будет отличаться для разных размеров OLE-объекта и встроенной книги Excel.
## **Причина изменения размера**
Поскольку у книги Excel есть свой собственный размер окна, она пытается сохранить свой первоначальный размер при первой активации. С другой стороны, OLE-объект будет иметь свой собственный размер. Согласно Microsoft, при активации книги Excel Excel и PowerPoint согласовывают размер и обеспечивают его правильные пропорции как часть операции встраивания. На основе различий в размерах окон Excel и размере / положении OLE-объекта происходит изменение размера.
## **Рабочее решение**
Существуют два возможных сценария создания презентаций PowerPoint с использованием Aspose.Slides для Java. **Сценарий 1:** Создание презентации на основе существующего шаблона **Сценарий 2:** Создание презентации с нуля. Решение, которое мы предоставим здесь, будет действовать для обоих сценариев. Основой всех подходов к решению будет одно и то же. То есть: **Размер окна встроенного OLE-объекта должен быть равен размеру OLE-объекта** **в слайде PowerPoint**. Теперь мы обсудим два подхода к решению.
## **Первый подход**
В этом подходе мы узнаем, как установить размер окна встроенной книги Excel, эквивалентный размеру OLE-объекта в слайде PowerPoint. **Сценарий 1** Предположим, мы определили шаблон и хотим создать презентации на основе этого шаблона. Предположим, в шаблоне есть какая-то фигура на индексе 2, где мы хотим разместить OLE-объект, содержащий встроенную книгу Excel. В этом сценарии размер OLE-объекта будет считаться предопределенным (что является размером фигуры на индексе 2 в шаблоне). Все, что нам нужно сделать: установить размер окна книги Excel равным размеру фигуры. Следующий кодовый фрагмент будет служить этой цели:

{{< gist "aspose-com-gists" "1f55f0222bc39a382d831900e8de7400" "Examples-src-main-java-com-aspose-slides-examples-Slides-Charts-ResizeChartWithExistingTemplate-ResizeChartWithExistingTemplate.java" >}}

**Сценарий 2** 
Предположим, мы хотим создать презентацию с нуля и желаем иметь OLE-объект любого размера с встроенной книгой Excel. В следующем кодовом фрагменте мы создали OLE-объект с высотой 4 дюйма и шириной 9,5 дюйма на слайде по координате x=0,5 дюйма и y=1 дюйм. Далее, мы установили эквивалентный размер окна книги Excel, то есть: высота 4 дюйма и ширина 9,5 дюйма.

{{< gist "aspose-com-gists" "1f55f0222bc39a382d831900e8de7400" "Examples-src-main-java-com-aspose-slides-examples-Slides-Charts-ResizeChartFromScratch-ResizeChartFromScratch.java" >}}


## **Второй подход**
В этом подходе мы узнаем, как установить размер диаграммы, присутствующий в встроенной книге Excel, эквивалентный размеру OLE-объекта в слайде PowerPoint. Этот подход полезен, когда размер диаграммы заранее известен и никогда не изменится. **Сценарий 1** Предположим, мы определили шаблон и хотим создать презентации на основе этого шаблона. Предположим, в шаблоне есть какая-то фигура на индексе 2, где мы хотим разместить OLE-объект, содержащий встроенную книгу Excel. В этом сценарии размер OLE-объекта будет считаться предопределенным (что является размером фигуры на индексе 2 в шаблоне). Все, что нам нужно сделать: установить размер диаграммы в книге Excel равным размеру фигуры. Следующий кодовый фрагмент будет служить этой цели:

{{< gist "aspose-com-gists" "1f55f0222bc39a382d831900e8de7400" "Examples-src-main-java-com-aspose-slides-examples-Slides-Charts-ResizeChartWithExistingTemplateSecondApproach-ResizeChartWithExistingTemplateSecondApproach.java" >}}

**Сценарий 2:** Предположим, мы хотим создать презентацию с нуля и желаем иметь OLE-объект любого размера с встроенной книгой Excel. В следующем кодовом фрагменте мы создали OLE-объект с высотой 4 дюйма и шириной 9,5 дюйма на слайде по координате x=0,5 дюйма и y=1 дюйм. Далее, мы установили эквивалентный размер диаграммы, то есть: высота 4 дюйма и ширина 9,5 дюйма.

{{< gist "aspose-com-gists" "1f55f0222bc39a382d831900e8de7400" "Examples-src-main-java-com-aspose-slides-examples-Slides-Charts-ResizeChartFromScratchSecondApproach-ResizeChartFromScratchSecondApproach.java" >}}
## **Заключение**
{{% alert color="primary" %}} 

Существует два подхода для решения проблемы изменения размера диаграммы. Выбор соответствующего подхода зависит от требований и конкретного случая использования. Оба подхода работают одинаково независимо от того, создаются ли презентации из шаблона или с нуля. Также нет предела по размеру OLE-объекта в данном решении.

{{% /alert %}}