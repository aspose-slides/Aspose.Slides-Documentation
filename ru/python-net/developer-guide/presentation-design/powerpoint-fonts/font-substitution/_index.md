---
title: "Настройка замены шрифтов в презентациях с помощью Python"
linktitle: "Замена шрифтов"
type: docs
weight: 70
url: /ru/python-net/font-substitution/
keywords:
- шрифт
- заменять шрифт
- замена шрифта
- заменить шрифт
- замена шрифта
- правило замещения
- правило замены
- PowerPoint
- OpenDocument
- презентация
- Python
- Aspose.Slides
description: "Включите оптимальную замену шрифтов в Aspose.Slides для Python через .NET при конвертации презентаций PowerPoint и OpenDocument в другие форматы файлов."
---

## **Установить правила замещения**

Aspose.Slides позволяет задавать правила для шрифтов, которые определяют, что делать в определённых условиях (например, когда шрифт недоступен) следующим образом:

1. Загрузите соответствующую презентацию.  
2. Загрузите шрифт, который будет заменён.  
3. Загрузите новый шрифт.  
4. Добавьте правило для замены.  
5. Добавьте правило в коллекцию правил замещения шрифтов презентации.  
6. Сгенерируйте изображение слайда, чтобы увидеть эффект.

Этот код на Python демонстрирует процесс замены шрифтов:

```python
import aspose.slides as slides

# Загружает презентацию
with slides.Presentation(path + "Fonts.pptx") as presentation:
    # Загружает исходный шрифт, который будет заменён
    sourceFont = slides.FontData("SomeRareFont")

    # Загружает новый шрифт
    destFont = slides.FontData("Arial")

    # Добавляет правило шрифта для замены шрифтов
    fontSubstRule = slides.FontSubstRule(sourceFont, destFont, slides.FontSubstCondition.WHEN_INACCESSIBLE)

    # Добавляет правило в коллекцию правил замещения шрифтов
    fontSubstRuleCollection = slides.FontSubstRuleCollection()
    fontSubstRuleCollection.add(fontSubstRule)

    # Добавляет коллекцию правил шрифтов в список правил
    presentation.fonts_manager.font_subst_rule_list = fontSubstRuleCollection

    # Шрифт Arial будет использоваться вместо SomeRareFont, когда последний недоступен
    with presentation.slides[0].get_image(1, 1) as bmp:
        # Сохраняет изображение на диск в формате JPEG
        bmp.save("Thumbnail_out.jpg", slides.ImageFormat.JPEG)
```

{{%  alert title="ЗАМЕЧАНИЕ"  color="warning"   %}} 
Возможно, вам будет интересно посмотреть [**Замена шрифтов**](/slides/ru/python-net/font-replacement/). 
{{% /alert %}}

## **Вопросы и ответы**

**В чём разница между заменой шрифтов и их замещением?**  
[Replacement](/slides/ru/python-net/font-replacement/) — это принудительное переопределение одного шрифта другим во всей презентации. Замещение — правило, которое срабатывает при определённом условии, например когда оригинальный шрифт недоступен, и тогда используется указанный запасной шрифт.

**Когда именно применяются правила замещения?**  
Правила участвуют в стандартной последовательности [выбора шрифта](/slides/ru/python-net/font-selection-sequence/), которая оценивается при загрузке, рендеринге и конвертации; если выбранный шрифт недоступен, применяется замена или замещение.

**Каково поведение по умолчанию, если ни замена, ни замещение не настроены, а шрифт отсутствует в системе?**  
Библиотека попытается выбрать наиболее близкий доступный шрифт системы, аналогично тому, как это делает PowerPoint.

**Можно ли добавить пользовательские внешние шрифты во время выполнения, чтобы избежать замещения?**  
Да. Вы можете [добавить внешние шрифты](/slides/ru/python-net/custom-font/) во время выполнения, чтобы библиотека учитывала их при выборе и рендеринге, включая последующие конвертации.

**Распространяет ли Aspose какие‑либо шрифты вместе с библиотекой?**  
Нет. Aspose не распространяет платные или бесплатные шрифты; вы добавляете и используете шрифты по собственному усмотрению и ответственности.

**Есть ли различия в поведении замещения на Windows, Linux и macOS?**  
Да. Поиск шрифтов начинается из каталогов шрифтов операционной системы. Набор доступных шрифтов по умолчанию и пути поиска различаются между платформами, что влияет на доступность и необходимость замещения.

**Как подготовить окружение, чтобы минимизировать неожиданное замещение при пакетных конверсиях?**  
Синхронизируйте набор шрифтов между машинами или контейнерами, [добавьте внешние шрифты](/slides/ru/python-net/custom-font/) необходимые для выходных документов, и [встраивайте шрифты](/slides/ru/python-net/embedded-font/) в презентации, когда это возможно, чтобы выбранные шрифты были доступны во время рендеринга.