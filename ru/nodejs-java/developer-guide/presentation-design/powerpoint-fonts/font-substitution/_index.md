---
title: Подстановка шрифтов - PowerPoint JavaScript API
linktitle: Подстановка шрифтов
type: docs
weight: 70
url: /ru/nodejs-java/font-substitution/
keywords: "Шрифт, подстановка шрифта, презентация PowerPoint, Java, Aspose.Slides для Node.js через Java"
description: "Подмена шрифта в PowerPoint с помощью JavaScript"
---

## **Установить правила замены шрифтов**

Aspose.Slides позволяет задавать правила для шрифтов, определяющие, что следует сделать в определённых условиях (например, когда шрифт недоступен) следующим образом:

1. Загрузите соответствующую презентацию.  
2. Загрузите шрифт, который будет заменён.  
3. Загрузите новый шрифт.  
4. Добавьте правило замены.  
5. Добавьте правило в коллекцию правил замены шрифтов презентации.  
6. Сгенерируйте изображение слайда, чтобы увидеть эффект.

Этот JavaScript‑код демонстрирует процесс замены шрифтов:
```javascript
// Загружает презентацию
var pres = new aspose.slides.Presentation("Fonts.pptx");
try {
    // Загружает исходный шрифт, который будет заменён
    var sourceFont = new aspose.slides.FontData("SomeRareFont");
    // Загружает новый шрифт
    var destFont = new aspose.slides.FontData("Arial");
    // Добавляет правило шрифта для замены шрифта
    var fontSubstRule = new aspose.slides.FontSubstRule(sourceFont, destFont, aspose.slides.FontSubstCondition.WhenInaccessible);
    // Добавляет правило в коллекцию правил замены шрифтов
    var fontSubstRuleCollection = new aspose.slides.FontSubstRuleCollection();
    fontSubstRuleCollection.add(fontSubstRule);
    // Добавляет коллекцию правил шрифтов в список правил
    pres.getFontsManager().setFontSubstRuleList(fontSubstRuleCollection);
    // Шрифт Arial будет использован вместо SomeRareFont, когда последний недоступен
    var slideImage = pres.getSlides().get_Item(0).getImage(1.0, 1.0);
    // Сохраняет изображение на диск в формате JPEG
    try {
        slideImage.save("Thumbnail_out.jpg", aspose.slides.ImageFormat.Jpeg);
    } finally {
        if (slideImage != null) {
            slideImage.dispose();
        }
    }
} finally {
    if (pres != null) {
        pres.dispose();
    }
}
```


{{%  alert title="NOTE"  color="warning"   %}} 
Возможно, вам будет интересно посмотреть [**Замена шрифтов**](/slides/ru/nodejs-java/font-replacement/).
{{% /alert %}}

## **Часто задаваемые вопросы**

**В чём разница между заменой шрифтов и их подстановкой?**

[Замена](/slides/ru/nodejs-java/font-replacement/) — это принудительное переопределение одного шрифта другим по всей презентации. Подстановка — это правило, которое срабатывает при определённом условии, например когда оригинальный шрифт недоступен, и тогда используется назначенный резервный шрифт.

**Когда именно применяются правила подстановки?**

Правила участвуют в стандартной последовательности [выбор шрифта](/slides/ru/nodejs-java/font-selection-sequence/), которая оценивается во время загрузки, рендеринга и конвертации; если выбранный шрифт недоступен, применяется замена или подстановка.

**Каково поведение по умолчанию, если ни замена, ни подстановка не настроены, а шрифт отсутствует в системе?**

Библиотека попытается подобрать ближайший доступный системный шрифт, аналогично тому, как это делает PowerPoint.

**Могу ли я присоединять пользовательские внешние шрифты во время выполнения, чтобы избежать подстановки?**

Да. Вы можете [добавить внешние шрифты](/slides/ru/nodejs-java/custom-font/) во время выполнения, чтобы библиотека учитывала их при выборе и рендеринге, включая последующие конвертации.

**Поставляет ли Aspose какие‑либо шрифты вместе с библиотекой?**

Нет. Aspose не распространяет платные или бесплатные шрифты; вы добавляете и используете шрифты по своему усмотрению и ответственности.

**Есть ли различия в поведении подстановки на Windows, Linux и macOS?**

Да. Поиск шрифтов начинается с каталогов шрифтов операционной системы. Набор доступных по умолчанию шрифтов и пути поиска различаются между платформами, что влияет на доступность и необходимость подстановки.

**Как подготовить окружение, чтобы минимизировать неожиданную подстановку при пакетных конверсиях?**

Синхронизируйте набор шрифтов между машинами или контейнерами, [добавьте внешние шрифты](/slides/ru/nodejs-java/custom-font/) необходимые для итоговых документов и [внедрите шрифты](/slides/ru/nodejs-java/embedded-font/) в презентации, когда это возможно, чтобы выбранные шрифты были доступны во время рендеринга.