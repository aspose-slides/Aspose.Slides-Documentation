---
title: Настройка областей построения диаграмм презентаций в .NET
linktitle: Область построения
type: docs
url: /ru/net/chart-plot-area/
keywords:
- диаграмма
- область построения
- ширина области построения
- высота области построения
- размер области построения
- режим размещения
- PowerPoint
- презентация
- .NET
- C#
- Aspose.Slides
description: "Узнайте, как настраивать области построения диаграмм в презентациях PowerPoint с помощью Aspose.Slides для .NET. Легко улучшайте визуальное оформление слайдов."
---

## **Получить ширину и высоту области построения диаграммы**
Aspose.Slides для .NET предоставляет простой API для .

1. Создайте экземпляр класса [Presentation](https://reference.aspose.com/slides/net/aspose.slides/presentation).
2. Получите доступ к первому слайду.
3. Добавьте диаграмму с данными по умолчанию.
4. Вызовите метод IChart.ValidateChartLayout() перед получением фактических значений.
5. Получает фактическое положение X (слева) элемента диаграммы относительно левого верхнего угла диаграммы.
6. Получает фактическую верхнюю позицию элемента диаграммы относительно левого верхнего угла диаграммы.
7. Получает фактическую ширину элемента диаграммы.
8. Получает фактическую высоту элемента диаграммы.
```c#
using (Presentation pres = new Presentation("test.Pptx"))
{
    Chart chart = (Chart)pres.Slides[0].Shapes.AddChart(ChartType.ClusteredColumn, 100, 100, 500, 350);
    chart.ValidateChartLayout();

    double x = chart.PlotArea.ActualX;
    double y = chart.PlotArea.ActualY;
    double w = chart.PlotArea.ActualWidth;
    double h = chart.PlotArea.ActualHeight;
	
	// Сохранить презентацию с диаграммой
	pres.Save("Chart_out.pptx", SaveFormat.Pptx);
}
```





## **Установить режим размещения области построения диаграммы**
Aspose.Slides для .NET предоставляет простой API для установки режима размещения области построения диаграммы. Свойство **LayoutTargetType** было добавлено в классы **ChartPlotArea** и **IChartPlotArea**. Если размещение области построения задаётся вручную, это свойство указывает, размещать область по её внутренней части (не включая оси и подписи осей) или внешней части (включая оси и подписи осей). Существует два возможных значения, определённых в перечислении **LayoutTargetType**.

- **LayoutTargetType.Inner** — указывает, что размер области построения определяет размер области построения без учёта делений и подписей осей.
- **LayoutTargetType.Outer** — указывает, что размер области построения определяет размер области построения, деления и подписи осей.

Пример кода приведён ниже.
```c#
using (Presentation presentation = new Presentation())
{
    ISlide slide = presentation.Slides[0];
    IChart chart = slide.Shapes.AddChart(ChartType.ClusteredColumn, 20, 100, 600, 400);
    chart.PlotArea.AsILayoutable.X = 0.2f;
    chart.PlotArea.AsILayoutable.Y = 0.2f;
    chart.PlotArea.AsILayoutable.Width = 0.7f;
    chart.PlotArea.AsILayoutable.Height = 0.7f;
    chart.PlotArea.LayoutTargetType = LayoutTargetType.Inner;

    presentation.Save("SetLayoutMode_outer.pptx", SaveFormat.Pptx);
}
```


## **FAQ**

**В каких единицах возвращаются ActualX, ActualY, ActualWidth и ActualHeight?**

В пунктах; 1 дюйм = 72 пункта. Это координатные единицы Aspose.Slides.

**Чем область построения отличается от области диаграммы по содержимому?**

Область построения — это область рисования данных (серии, сетка, линии тренда и т. д.); область диаграммы включает окружающие элементы (заголовок, легенду и т. д.). В 3D‑диаграммах область построения также включает стены/пол и оси.

**Как интерпретируются X, Y, Width и Height области построения при ручном размещении?**

Это доли (0–1) от общего размера диаграммы; в этом режиме автоматическое позиционирование отключено, и используются заданные вами доли.

**Почему позиция области построения изменилась после добавления/перемещения легенды?**

Легенда находится в области диаграммы за пределами области построения, но влияет на размещение и доступное пространство, поэтому область построения может сместиться, когда включено автоматическое позиционирование. (Это стандартное поведение диаграмм PowerPoint.)