---
title: Настройка подстановки шрифтов в презентациях в .NET
linktitle: Подстановка шрифтов
type: docs
weight: 70
url: /ru/net/font-substitution/
keywords:
- шрифт
- заменяющий шрифт
- подстановка шрифтов
- замена шрифта
- замена шрифта
- правило подстановки
- правило замены
- PowerPoint
- OpenDocument
- презентация
- .NET
- C#
- Aspose.Slides
description: "Обеспечьте оптимальную подстановку шрифтов в Aspose.Slides для .NET при конвертации презентаций PowerPoint и OpenDocument в другие форматы файлов."
---

## **Получение подстановки шрифтов**

Чтобы вы могли узнать, какие шрифты презентации заменяются во время процесса рендеринга презентации, Aspose.Slides предоставляет метод [GetSubstitution](https://reference.aspose.com/slides/net/aspose.slides/fontsmanager/getsubstitutions/) из интерфейса [IFontsManager](https://reference.aspose.com/slides/net/aspose.slides/ifontsmanager/).

C#‑код показывает, как получить все подстановки шрифтов, выполняемые при рендеринге презентации:
```c#
using (Presentation pres = new Presentation(@"Presentation.pptx"))
{
    foreach (var fontSubstitution in pres.FontsManager.GetSubstitutions())
    {
        Console.WriteLine("{0} -> {1}", fontSubstitution.OriginalFontName, fontSubstitution.SubstitutedFontName);
    }
}
```



## **Задание правил подстановки шрифтов**

Aspose.Slides позволяет задавать правила для шрифтов, определяющие, что необходимо сделать в определённых условиях (например, когда шрифт недоступен), следующим образом:

1. Загрузите нужную презентацию.  
2. Загрузите шрифт, который будет заменён.  
3. Загрузите новый шрифт.  
4. Добавьте правило замены.  
5. Добавьте правило в коллекцию правил замены шрифтов презентации.  
6. Сгенерируйте изображение слайда, чтобы увидеть результат.

Этот C#‑код демонстрирует процесс подстановки шрифтов:
```c#
// Загружает презентацию
Presentation presentation = new Presentation("Fonts.pptx");

// Загружает исходный шрифт, который будет заменён
IFontData sourceFont = new FontData("SomeRareFont");

// Загружает новый шрифт
IFontData destFont = new FontData("Arial");

// Добавляет правило замены шрифта
IFontSubstRule fontSubstRule = new FontSubstRule(sourceFont, destFont, FontSubstCondition.WhenInaccessible);

// Добавляет правило в коллекцию правил подстановки шрифтов
IFontSubstRuleCollection fontSubstRuleCollection = new FontSubstRuleCollection();
fontSubstRuleCollection.Add(fontSubstRule);

// Добавляет коллекцию правил шрифтов в список правил
presentation.FontsManager.FontSubstRuleList = fontSubstRuleCollection;

using (IImage image = presentation.Slides[0].GetImage(1f, 1f))
{
    // Сохраняет изображение на диск в формате JPEG
    image.Save("Thumbnail_out.jpg", ImageFormat.Jpeg);
}
```


{{%  alert title="NOTE"  color="warning"   %}} 

Возможно, вам будет интересно посмотреть [**Замена шрифтов**](/slides/ru/net/font-replacement/). 

{{% /alert %}}

## **Часто задаваемые вопросы**

**В чем разница между заменой шрифтов и подстановкой шрифтов?**

[Замена](/slides/ru/net/font-replacement/) — принудительное переопределение одного шрифта другим во всей презентации. Подстановка — правило, которое срабатывает при определённом условии, например когда оригинальный шрифт недоступен, и тогда используется назначенный запасной шрифт.

**Когда именно применяются правила подстановки?**

Правила участвуют в стандартной последовательности [выбора шрифта](/slides/ru/net/font-selection-sequence/), которая оценивается во время загрузки, рендеринга и конвертации; если выбранный шрифт недоступен, применяется замена или подстановка.

**Каково поведение по умолчанию, если ни замена, ни подстановка не настроены и шрифт отсутствует в системе?**

Библиотека попытается выбрать наиболее близкий доступный системный шрифт, аналогично тому, как это делает PowerPoint.

**Могу ли я подключать пользовательские внешние шрифты во время выполнения, чтобы избежать подстановки?**

Да. Вы можете [добавлять внешние шрифты](/slides/ru/net/custom-font/) во время выполнения, чтобы библиотека учитывала их при выборе и рендеринге, включая последующие конвертации.

**Распределяет ли Aspose какие-либо шрифты вместе с библиотекой?**

Нет. Aspose не распространяет платные или бесплатные шрифты; вы добавляете и используете шрифты по собственному усмотрению и ответственности.

**Есть ли различия в поведении подстановки на Windows, Linux и macOS?**

Да. Поиск шрифтов начинается с каталогов шрифтов операционной системы. Набор доступных по умолчанию шрифтов и пути поиска различаются между платформами, что влияет на их наличие и необходимость подстановки.

**Как подготовить окружение, чтобы минимизировать неожиданную подстановку при пакетных конверсиях?**

Синхронизируйте набор шрифтов между машинами или контейнерами, [добавьте внешние шрифты](/slides/ru/net/custom-font/) необходимые для выходных документов, и по возможности [встраивайте шрифты](/slides/ru/net/embedded-font/) в презентации, чтобы выбранные шрифты были доступны во время рендеринга.