---
title: Настройка подстановки шрифтов в презентациях на Android
linktitle: Подстановка шрифтов
type: docs
weight: 70
url: /ru/androidjava/font-substitution/
keywords:
- шрифт
- замена шрифта
- подстановка шрифта
- заменить шрифт
- замена шрифта
- правило подстановки
- правило замены
- PowerPoint
- OpenDocument
- презентация
- Android
- Java
- Aspose.Slides
description: "Обеспечьте оптимальную подстановку шрифтов в Aspose.Slides для Android через Java при конвертации презентаций PowerPoint и OpenDocument в другие форматы файлов."
---

## **Настройка правил подстановки шрифтов**

Aspose.Slides позволяет задавать правила для шрифтов, определяющие, что должно происходить в определённых условиях (например, когда шрифт недоступен), следующим образом:

1. Загрузите соответствующую презентацию.
2. Загрузите шрифт, который будет заменён.
3. Загрузите новый шрифт.
4. Добавьте правило замены.
5. Добавьте правило в коллекцию правил замены шрифтов презентации.
6. Сгенерируйте изображение слайда, чтобы увидеть результат.

Этот Java‑код демонстрирует процесс подстановки шрифтов:
```java
// Загружает презентацию
Presentation pres = new Presentation("Fonts.pptx");
try {
    // Загружает исходный шрифт, который будет заменён
    IFontData sourceFont = new FontData("SomeRareFont");
    
    // Загружает новый шрифт
    IFontData destFont = new FontData("Arial");
    
    // Добавляет правило замены шрифта
    IFontSubstRule fontSubstRule = new FontSubstRule(sourceFont, destFont, FontSubstCondition.WhenInaccessible);
    
    // Добавляет правило в коллекцию правил подстановки шрифтов
    IFontSubstRuleCollection fontSubstRuleCollection = new FontSubstRuleCollection();
    fontSubstRuleCollection.add(fontSubstRule);
    
    // Добавляет коллекцию правил шрифтов в список правил
    pres.getFontsManager().setFontSubstRuleList(fontSubstRuleCollection);
    
    // Шрифт Arial будет использован вместо SomeRareFont, когда последний недоступен
    IImage slideImage = pres.getSlides().get_Item(0).getImage(1f, 1f);
    
    // Сохраняет изображение на диск в формате JPEG
    try {
          slideImage.save("Thumbnail_out.jpg", ImageFormat.Jpeg);
    } finally {
         if (slideImage != null) slideImage.dispose();
    }
} finally {
    if (pres != null) pres.dispose();
}
```


{{%  alert title="NOTE"  color="warning"   %}} 

Возможно, вам будет интересно посмотреть [**Font Replacement**](/slides/ru/androidjava/font-replacement/).

{{% /alert %}}

## **FAQ**

**В чём разница между заменой шрифта и его подстановкой?**

[Replacement](/slides/ru/androidjava/font-replacement/) — принудительная переопределение одного шрифта другим во всей презентации. Подстановка — правило, которое срабатывает при определённом условии, например когда оригинальный шрифт недоступен, и тогда используется указанный запасной шрифт.

**Когда именно применяются правила подстановки?**

Правила участвуют в стандартной последовательности [font selection](/slides/ru/androidjava/font-selection-sequence/), которая оценивается при загрузке, рендеринге и конвертации; если выбранный шрифт недоступен, применяется замена или подстановка.

**Каково поведение по умолчанию, если ни замена, ни подстановка не настроены и шрифт отсутствует в системе?**

Библиотека попробует подобрать ближайший доступный системный шрифт, аналогично тому, как это делает PowerPoint.

**Могу ли я подключать пользовательские внешние шрифты во время выполнения, чтобы избежать подстановки?**

Да. Вы можете [add external fonts](/slides/ru/androidjava/custom-font/) во время выполнения, чтобы библиотека учитывала их при выборе и рендеринге, включая последующие конвертации.

**Распределяет ли Aspose какие‑либо шрифты вместе с библиотекой?**

Нет. Aspose не распространяет ни платные, ни бесплатные шрифты; вы добавляете и используете шрифты по собственному усмотрению и ответственности.

**Есть ли различия в поведении подстановки на Windows, Linux и macOS?**

Да. Поиск шрифтов начинается с каталогов шрифтов операционной системы. Набор доступных по умолчанию шрифтов и пути поиска различаются на разных платформах, что влияет на их доступность и необходимость подстановки.

**Как подготовить окружение, чтобы минимизировать неожиданную подстановку при пакетных конверсиях?**

Синхронизуйте набор шрифтов между машинами или контейнерами, [add the external fonts](/slides/ru/androidjava/custom-font/) необходимые для выходных документов, и [embed fonts](/slides/ru/androidjava/embedded-font/) в презентациях, когда это возможно, чтобы выбранные шрифты были доступны во время рендеринга.