---
title: تطبيق صيغ ورقة عمل المخطط في العروض التقديمية باستخدام .NET
linktitle: صيغ ورقة العمل
type: docs
weight: 70
url: /ar/net/chart-worksheet-formulas/
keywords:
- جدول بيانات المخطط
- ورقة عمل المخطط
- صيغة المخطط
- صيغة ورقة العمل
- صيغة جدول البيانات
- مصدر البيانات
- ثابت منطقي
- ثابت رقمي
- ثابت نصي
- ثابت خطأ
- ثابت حسابي
- عامل مقارنة
- نمط A1
- نمط R1C1
- دالة معرفة مسبقًا
- PowerPoint
- عرض تقديمي
- .NET
- C#
- Aspose.Slides
description: "تطبيق صيغ بنمط Excel في Aspose.Slides لورقات عمل مخططات .NET وتلقائية التقارير عبر ملفات PPT و PPTX."
---

## **حول صيغ جدول بيانات المخطط في العروض التقديمية**
**Chart spreadsheet** (أو ورقة عمل المخطط) في العرض التقديمي هي مصدر البيانات للمخطط. يحتوي جدول بيانات المخطط على البيانات التي يتم تمثيلها على المخطط بصورة رسومية. عند إنشاء مخطط في PowerPoint، يتم إنشاء ورقة العمل المرتبطة بهذا المخطط تلقائيًا أيضًا. يتم إنشاء ورقة عمل المخطط لجميع أنواع المخططات: مخطط خطي، مخطط شريطي، مخطط متسلسل، مخطط دائري، إلخ. لرؤية جدول بيانات المخطط في PowerPoint يجب النقر مزدوجًا على المخطط:

![todo:image_alt_text](chart-worksheet-formulas_1.png)



يحتوي جدول بيانات المخطط على أسماء عناصر المخطط (اسم الفئة: *Category1*، اسم السلسلة) وجدول بالبيانات الرقمية المناسبة لتلك الفئات والسلسلات. بشكل افتراضي، عندما تنشئ مخططًا جديدًا – يتم ضبط بيانات جدول بيانات المخطط بالبيانات الافتراضية. ثم يمكنك تعديل بيانات الجدول يدويًا في ورقة العمل.

عادةً ما يمثل المخطط بيانات معقدة (مثل المحللين الماليين أو العلماء)، تحتوي على خلايا تُحسب من القيم في خلايا أخرى أو من بيانات ديناميكية أخرى. حساب قيمة الخلية يدويًا وتسجيلها صلبًا داخل الخلية يجعل من الصعب تغييرها في المستقبل. إذا قمت بتغيير قيمة خلية معينة، سيتطلب تحديث جميع الخلايا المعتمدة على تلك القيمة أيضًا. علاوة على ذلك، قد تعتمد بيانات الجدول على بيانات جداول أخرى، مما يخلق مخطط بيانات عرض تقديمي معقد يحتاج إلى تحديث بطريقة سهلة ومرنة.

**Chart spreadsheet formula** في العرض التقديمي هي تعبير لحساب وتحديث بيانات جدول بيانات المخطط تلقائيًا. تحدد صيغة الجدول المنطقية حساب البيانات لخلية معينة أو لمجموعة خلايا. صيغة الجدول هي صيغة رياضية أو منطقية تستخدم: مراجع خلايا، دوال رياضية، معاملات منطقية، معاملات حسابية، دوال تحويل، ثوابت نصية، إلخ. يتم كتابة تعريف الصيغة داخل خلية، وهذه الخلية لا تحتوي على قيمة بسيطة. تحسب صيغة الجدول القيمة وتعيدها، ثم تُعيَّن هذه القيمة إلى الخلية. صيغ جدول بيانات المخطط في العروض التقديمية هي نفسها صيغ Excel، وتُدعم نفس الدوال الافتراضية، المعاملات والثوابت لتنفيذها.

في [**Aspose.Slides**](https://products.aspose.com/slides/net/) يُمثَّل جدول بيانات المخطط بـ
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdata/properties/chartdataworkbook) الخاص بـ
[**IChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdataworkbook). 
يمكن تعيين صيغة الجدول وتغييرها باستخدام
[**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula). 
الوظائف التالية مدعومة للصيغ في Aspose.Slides:

- ثوابت منطقية
- ثوابت رقمية
- ثوابت نصية
- ثوابت أخطاء
- معاملات حسابية
- معاملات مقارنة
- مراجع خلايا بنمط A1
- مراجع خلايا بنمط R1C1
- دوال معرفة مسبقًا



عادةً ما تخزن الجداول قيم الصيغ المحسوبة الأخيرة. إذا لم تتغير بيانات المخطط بعد تحميل العرض التقديمي – تُعيد خاصية **IChartDataCell.Value** تلك القيم أثناء القراءة. لكن، إذا تم تغيير بيانات جدول البيانات، فإن قراءة خاصية **ChartDataCell.Value** تُلقي استثناء **CellUnsupportedDataException** للصيغ غير المدعومة. يحدث هذا لأن الصيغ التي تُحلل بنجاح تُحدِّد تبعيات الخلايا وتتحقق من صحة القيم الأخيرة. أما إذا لم تُحلل الصيغة، فلا يمكن ضمان صحة قيمة الخلية.

## **إضافة صيغة جدول بيانات المخطط إلى عرض تقديمي**
أولاً، أضف مخططًا مع بعض البيانات التجريبية إلى الشريحة الأولى من عرض تقديمي جديد باستخدام
[IShapeCollection.Shapes.AddChart](https://reference.aspose.com/slides/net/aspose.slides.ishapecollection/addchart/methods/1). 
تُنشأ ورقة عمل المخطط تلقائيًا ويمكن الوصول إليها عبر
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdata/properties/chartdataworkbook) الخاص بها:
``` csharp

using (var presentation = new Presentation())

{

    IChart chart = presentation.Slides[0].Shapes.AddChart(ChartType.ClusteredColumn, 150, 150, 500, 300);

    IChartDataWorkbook workbook = chart.ChartData.ChartDataWorkbook;

    // ...

}

```


لنكتب بعض القيم في الخلايا باستخدام
[**IChartDataCell.Value**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/value) الخاص
بنوع **Object**، مما يعني أنه يمكنك تعيين أي قيمة لهذه الخاصية:
``` csharp

workbook.GetCell(0, "F2").Value = -2.5;

workbook.GetCell(0, "G3").Value = 6.3;

workbook.GetCell(0, "H4").Value = 3;

```


الآن لكتابة صيغة إلى الخلية، يمكنك استخدام
[**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula) الخاص بها:
``` csharp
workbook.GetCell(0, "B2").Formula = "F2+G3+H4+1";
```


*ملاحظة*: خاصية [**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula) تُستخدم لتعيين مراجع خلايا بنمط A1.

لتعيين مرجع الخلية بـ[R1C1Formula](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/r1c1formula)، يمكنك استخدام خاصية
[**IChartDataCell.R1C1Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/r1c1formula):
``` csharp
workbook.GetCell(0, "C2").R1C1Formula = "R[1]C[4]/R[2]C[5]";
```


بعد ذلك استخدم طريقة
[**IChartDataWorkbook.CalculateFormulas**](https://reference.aspose.com/slides/net/aspose.slides.charts/chartdataworkbook/methods/calculateformulas) لحساب جميع الصيغ داخل دفتر العمل وتحديث قيم الخلايا المقابلة:
``` csharp
workbook.CalculateFormulas();

object value1 = workbook.GetCell(0, "B2"); // 7.8

object value2 = workbook.GetCell(0, "C2"); // 2.1

```


## **الثوابت المنطقية**
يمكنك استخدام الثوابت المنطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:

## **الثوابت الرقمية**
يمكن استخدام الأرقام بصيغ عادية أو علمية لإنشاء صيغ جدول بيانات المخطط:

## **الثوابت النصية**
الثابت النصي (أو الحرفي) هو قيمة محددة تُستخدم كما هي ولا تتغير. قد تكون الثوابت النصية: تواريخ، نصوص، أرقام، إلخ:

## **ثوابت الأخطاء**
أحيانًا لا يمكن حساب النتيجة باستخدام الصيغة. في تلك الحالة يُظهر رمز الخطأ في الخلية بدلًا من قيمتها. لكل نوع من الأخطاء رمز محدد:

- #DIV/0! - تحاول الصيغة القسمة على الصفر.
- #GETTING_DATA - قد يُظهر على خلية بينما لا تزال قيمتها تُحسب.
- #N/A - المعلومات مفقودة أو غير متوفرة. بعض الأسباب قد تكون: الخلايا المستخدمة في الصيغة فارغة، وجود مساحة إضافية، كتابة خطأ، إلخ.
- #NAME? - لا يمكن العثور على خلية معينة أو كائن صيغة آخر بالاسم.
- #NULL! - قد يظهر عندما يكون هناك خطأ في الصيغة، مثل:  (,) أو مساحة بدلاً من نقطتين (:).
- #NUM! - الرقم في الصيغة قد يكون غير صالح، طويل جدًا أو قصير جدًا، إلخ.
- #REF! - مرجع خلية غير صالح.
- #VALUE! - نوع قيمة غير متوقع. على سبيل المثال، قيمة نصية مضبوطة في خلية عددية.

## **العوامل الحسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة عمل المخطط:

|**العامل**|**المعنى**|**مثال**|
| :- | :- | :- |
|+ (إشارة الجمع)|الجمع أو جمع أحادي|2 + 3|
|- (إشارة الطرح)|الطرح أو السالب|2 - 3<br>-3|
|* (نجمة)|الضرب|2 * 3|
|/ (شرطة مائلة)|القسمة|2 / 3|
|% (نسبة مئوية)|النسبة المئوية|30%|
|^ (ق caret)|الأس|2 ^ 3|

*ملاحظة*: لتغيير ترتيب التقييم، ضع الجزء الذي تريد حسابه أولاً بين أقواس.

## **العوامل المقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عند مقارنة قيمتين باستخدام هذه العوامل، تكون النتيجة قيمة منطقية إما *TRUE* أو FALSE:

|**العامل**|**المعنى**|**المعنى**|
| :- | :- | :- |
|= (علامة المساواة)|مساوي لـ|A2 = 3|
|<> (علامة عدم المساواة)|ليس مساويًا لـ|A2 <> 3|
|> (علامة أكبر من)|أكبر من|A2 > 3|
|>= (علامة أكبر من أو يساوي)|أكبر من أو يساوي|A2 >= 3|
|< (علامة أصغر من)|أصغر من|A2 < 3|
|<= (علامة أصغر من أو يساوي)|أصغر من أو يساوي|A2 <= 3|

## **مراجع خلايا بنمط A1**
**مراجع خلايا بنمط A1** تُستخدم في أوراق العمل التي يكون فيها العمود معرفًا بحرف (مثل "*A*") والصف معرفًا رقمًا (مثل "*1*"). يمكن استخدام مراجع خلايا نمط A1 بالطريقة التالية:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|$A$2|A2|<p>A$2</p><p>$A2</p>|
|صف|$2:$2|2:2|-|
|عمود|$A:$A|A:A|-|
|نطاق|$A$2:$C$4|A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|

فيما يلي مثال على كيفية استخدام مرجع خلايا بنمط A1 في صيغة:

## **مراجع خلايا بنمط R1C1**
**مراجع خلايا بنمط R1C1** تُستخدم في أوراق العمل التي يكون فيها كل من الصف والعمود معرفين رقميًا. يمكن استخدام مراجع خلايا نمط R1C1 بالطريقة التالية:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف|R2|R[2]|-|
|عمود|C3|C[3]|-|
|نطاق|R2C3:R5C7|R[2]C[3]:R[5]C[7]|R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|

فيما يلي مثال على كيفية استخدام مرجع خلايا بنمط A1 في صيغة:

## **الدوال المعرفة مسبقًا**
هناك دوال معرفة مسبقًا يمكن استخدامها في الصيغ لتبسيط تنفيذها. تُغلق هذه الدوال أكثر العمليات المستخدمة شيوعًا، مثل:

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام تاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (نموذج مرجع)
- LOOKUP (نموذج متجه)
- MATCH (نموذج متجه)
- MAX
- SUM
- VLOOKUP

## **الأسئلة المتكررة**

**هل تدعم ملفات Excel الخارجية كمصدر بيانات لمخطط يحتوي على صيغ؟**

نعم. يدعم Aspose.Slides دفاتر عمل خارجية كمصدر بيانات [للمخطط](https://reference.aspose.com/slides/net/aspose.slides.charts/chartdatasourcetype/)، مما يتيح لك استخدام صيغ من ملف XLSX خارج العرض التقديمي.

**هل يمكن لصيغ المخطط الإشارة إلى أوراق داخل نفس دفتر العمل باسم الورقة؟**

نعم. تتبع الصيغ نموذج مرجع Excel القياسي، لذا يمكنك الإشارة إلى أوراق أخرى داخل نفس دفتر العمل أو دفتر عمل خارجي. بالنسبة للإشارات الخارجية، تضمّن المسار واسم دفتر العمل باستخدام صيغة Excel.