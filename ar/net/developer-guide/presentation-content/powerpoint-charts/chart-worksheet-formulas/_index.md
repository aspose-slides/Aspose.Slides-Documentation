---
title: صيغ ورقة العمل للمخطط
type: docs
weight: 70
url: /net/chart-worksheet-formulas/
keywords: "جدول بيانات المخطط، صيغة المخطط، عرض تقديمي لباوربوينت، C#، Csharp، Aspose.Slides ل .NET"
description: "جدول بيانات المخطط وصيغة في عرض تقديمي لباوربوينت بلغة C# أو .NET"
---


## **حول صيغة جدول بيانات المخطط في العرض التقديمي**
**جدول بيانات المخطط** (أو ورقة العمل للمخطط) في العرض التقديمي هو مصدر البيانات للمخطط. يحتوي جدول بيانات المخطط على بيانات يتم تمثيلها على المخطط بطريقة رسومية. عند إنشاء مخطط في باوربوينت، يتم إنشاء ورقة العمل المرتبطة بهذا المخطط تلقائيًا. يتم إنشاء ورقة العمل للمخطط لجميع أنواع المخططات: مخطط خطي، مخطط عمودي، مخطط شمس، مخطط دائري، إلخ. لرؤية جدول بيانات المخطط في باوربوينت يجب عليك النقر نقرًا مزدوجًا على المخطط:

![todo:image_alt_text](chart-worksheet-formulas_1.png)



يحتوي جدول بيانات المخطط على أسماء عناصر المخطط (اسم الفئة: *الفئة1*، اسم السلسلة) وجدول بالبيانات الرقمية المناسبة لهذه الفئات والسلاسل. بشكل افتراضي، عند إنشاء مخطط جديد - يتم ضبط بيانات جدول بيانات المخطط بالبيانات الافتراضية. ثم يمكنك تغيير بيانات جدول البيانات في ورقة العمل يدويًا.

عادةً ما يمثل المخطط بيانات معقدة (على سبيل المثال: محللون ماليون، محللون علميون)، تحتوي على خلايا يتم حسابها من القيم في خلايا أخرى أو من بيانات ديناميكية أخرى. حساب قيمة الخلية يدويًا وترميزها بصرامة في الخلية، يجعل من الصعب تغييره في المستقبل. إذا كنت ستغير قيمة خلية معينة، فسيتطلب الأمر تحديث جميع الخلايا التابعة لها أيضًا. علاوة على ذلك، قد تعتمد بيانات الجدول على بيانات من جداول أخرى، مما ينشئ مخطط بيانات تقديمية معقدة تحتاج إلى تحديث بطريقة سهلة ومرنة.

**صيغة جدول بيانات المخطط** في العرض التقديمي هي تعبير لحساب وتحديث بيانات جدول بيانات المخطط تلقائيًا. تحدد صيغة جدول البيانات منطق حساب البيانات لخلية معينة أو مجموعة من الخلايا. صيغة جدول البيانات هي صيغة رياضية أو صيغة منطقية، والتي تستخدم: مراجع الخلايا، وظائف رياضية، عوامل منطقية، عوامل حسابية، دوال تحويل، ثوابت نصية، إلخ. يتم كتابة تعريف الصيغة في خلية، وهذه الخلية لا تحتوي على قيمة بسيطة. تحسب صيغة جدول البيانات القيمة وتعيدها، ثم يتم تعيين هذه القيمة للخلية. تعتبر صيغ جدول بيانات المخطط في العروض التقديمية في الواقع هي نفسها صيغ إكسل، وتدعم نفس الدوال، والعوامل، والثوابت الافتراضية لتنفيذها.

في [**Aspose.Slides**](https://products.aspose.com/slides/net/) يتم تمثيل جدول بيانات المخطط بواسطة 
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdata/properties/chartdataworkbook) خاصية من نوع
[**IChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdataworkbook). 
يمكن تعيين وتغيير صيغة جدول البيانات باستخدام 
[**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula) خاصية. 
تدعم Aspose.Slides الوظائف التالية للصيغ:

- ثوابت منطقية
- ثوابت رقمية
- ثوابت نصية
- ثوابت خطأ
- عوامل حسابية
- عوامل مقارنة
- مراجع خلايا بأسلوب A1
- مراجع خلايا بأسلوب R1C1
- دوال محددة مسبقًا



عادةً، تخزن جداول البيانات آخر قيم الصيغ المحسوبة. إذا لم تتغير بيانات المخطط بعد تحميل العرض التقديمي - فإن خاصية **IChartDataCell.Value** تعيد تلك القيم أثناء القراءة. ولكن، إذا تم تغيير بيانات جدول البيانات، أثناء قراءة خاصية **ChartDataCell.Value** يقوم بإلقاء استثناء **CellUnsupportedDataException** للصيغ غير المدعومة. يحدث ذلك لأنه عندما تتم معالجة الصيغ بنجاح، يتم تحديد تبعيات الخلايا وتحديد صحة القيم الأخيرة. ولكن، إذا لم يمكن تحليل الصيغة، فلا يمكن ضمان صحة قيمة الخلية.
## **إضافة صيغة جدول بيانات المخطط إلى العرض التقديمي**
أولاً، أضف مخططًا مع بعض البيانات النموذجية إلى الشريحة الأولى من عرض تقديمي جديد باستخدام 
[IShapeCollection.Shapes.AddChart](https://reference.aspose.com/slides/net/aspose.slides.ishapecollection/addchart/methods/1). 
تتم إنشاء ورقة العمل للمخطط تلقائيًا ويمكن الوصول إليها باستخدام 
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdata/properties/chartdataworkbook) خاصية:



``` csharp

using (var presentation = new Presentation())

{

    IChart chart = presentation.Slides[0].Shapes.AddChart(ChartType.ClusteredColumn, 150, 150, 500, 300);

    IChartDataWorkbook workbook = chart.ChartData.ChartDataWorkbook;

    // ...

}

```



دعنا نكتب بعض القيم في الخلايا باستخدام 
[**IChartDataCell.Value**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/value) خاصية 
من نوع **Object**، مما يعني أنه يمكنك تعيين أي قيمة للخاصية:



``` csharp

workbook.GetCell(0, "F2").Value = -2.5;

workbook.GetCell(0, "G3").Value = 6.3;

workbook.GetCell(0, "H4").Value = 3;

```



الآن لكتابة صيغة في الخلية، يمكنك استخدام خاصية 
[**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula):

``` csharp
workbook.GetCell(0, "B2").Formula = "F2+G3+H4+1";
```

*ملحوظة*: خاصية [**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula) تستخدم لتعيين مراجع خلايا بأسلوب A1. 



لتعيين الإسناد [R1C1Formula](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/r1c1formula) للخلية، يمكنك استخدام خاصية 
[**IChartDataCell.R1C1Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/r1c1formula):

``` csharp
workbook.GetCell(0, "C2").R1C1Formula = "R[1]C[4]/R[2]C[5]";
```

ثم استخدم طريقة [**IChartDataWorkbook.CalculateFormulas**](https://reference.aspose.com/slides/net/aspose.slides.charts/chartdataworkbook/methods/calculateformulas) لحساب جميع الصيغ داخل الدفتر وتحديث قيم الخلايا المقابلة:



``` csharp
workbook.CalculateFormulas();

object value1 = workbook.GetCell(0, "B2"); // 7.8

object value2 = workbook.GetCell(0, "C2"); // 2.1

```


## **الثوابت المنطقية**
يمكنك استخدام الثوابت المنطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:




## **الثوابت العددية**
يمكن استخدام الأرقام في الصيغ الشائعة أو العلمية لإنشاء صيغة جدول بيانات المخطط:




## **الثوابت النصية**
الثابت النصي (أو الثابت الحرفي) هو قيمة محددة تُستخدم كما هي ولا تتغير. يمكن أن تكون الثوابت النصية: تواريخ، نصوص، أرقام، إلخ:




## **ثوابت الخطأ**
أحيانًا قد لا يكون من الممكن حساب النتيجة من خلال الصيغة. في هذه الحالة، يتم عرض رمز الخطأ في الخلية بدلاً من قيمتها. لكل نوع من الخطأ رمز محدد:

- #DIV/0! - تحاول الصيغة القسمة على صفر.
- #GETTING_DATA - قد يظهر في خلية، بينما ما زالت قيمته قيد الحساب.
- #N/A - المعلومات مفقودة أو غير متاحة. بعض الأسباب يمكن أن تكون: الخلايا المستخدمة في الصيغة فارغة، حرف مسافة إضافي، أخطاء إملائية، إلخ.
- #NAME? - لا يمكن العثور على خلية معينة أو كائنات صيغة أخرى باسمها. 
- #NULL! - قد تظهر عندما يكون هناك خطأ في الصيغة، مثل:  (,) أو استخدام حرف مسافة بدلاً من نقطتين (:).
- #NUM! - قد تكون الأرقام في الصيغة غير صالحة، طويلة جدًا أو قصيرة جدًا، إلخ.
- #REF! - إسناد خلية غير صالح.
- #VALUE! - نوع قيمة غير متوقع. على سبيل المثال، تعيين قيمة نصية إلى خلية رقمية.




## **العوامل الحسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة العمل للمخطط:



|**العامل** |**المعنى** |**مثال**|
| :- | :- | :- |
|+ (علامة الجمع) |الإضافة أو الجمع الأحادي|2 + 3|
|- (علامة الطرح) |الطرح أو السالب |2 - 3<br>-3|
|* (نجمة)|الضرب |2 * 3|
|/ (شريطة متقدمة)|القسمة |2 / 3|
|% (علامة النسبة المئوية) |نسبة مئوية |30%|
|^ (علامة الاس)**|الأس|2 ^ 3|


*ملحوظة*: لتغيير ترتيب التقييم، قم بتغليف الجزء من الصيغة الذي سيتم حسابه أولاً في قوسين.


## **عوامل المقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عندما يتم مقارنة قيمتين باستخدام هذه العوامل، تكون النتيجة قيمة منطقية إما *TRUE* أو FALSE:



|**العامل** |**المعنى** |**المعنى** |
| :- | :- | :- |
|= (علامة المساواة) |يساوي |A2 = 3|
|<> (علامة عدم المساواة) |لا يساوي|A2 <> 3|
|> (علامة أكبر من) |أكبر من|A2 > 3|
|>= (علامة أكبر من أو يساوي)|أكبر من أو يساوي|A2 >= 3|
|< (علامة أقل من)|أقل من|A2 < 3|
|<= (علامة أقل من أو يساوي)|أقل من أو يساوي|A2 <= 3|

## **مراجع خلايا بأسلوب A1**
تستخدم **مراجع خلايا بأسلوب A1** لورقات العمل، حيث تحتوي العمود على محدد حرفي (مثل "*A*") والصف يحتوي على محدد عددي (مثل "*1*"). يمكن استخدام مراجع خلايا بأسلوب A1 بالطريقة التالية:



|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق |نسبي |مختلط|
|خلية |$A$2 |A2|<p>A$2</p><p>$A2</p>|
|صف |$2:$2 |2:2 |-|
|عمود |$A:$A |A:A |-|
|نطاق |$A$2:$C$4 |A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|


إليك مثال على كيفية استخدام مرجع خلية بأسلوب A1 في صيغة:




## **مراجع خلايا بأسلوب R1C1**
تستخدم **مراجع خلايا بأسلوب R1C1** لورقات العمل، حيث يحتوي كل من الصف والعمود على محدد عددي. يمكن استخدام مراجع خلايا بأسلوب R1C1 بالطريقة التالية:



|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطالع |نسبي |مختلط|
|خلية |R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف |R2|R[2]|-|
|عمود |C3|C[3]|-|
|نطاق |R2C3:R5C7|R[2]C[3]:R[5]C[7] |R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|


إليك مثال على كيفية استخدام مرجع خلية بأسلوب A1 في صيغة:




## **الدوال المحددة مسبقًا**
توجد دوال محددة مسبقًا، يمكن استخدامها في الصيغ لتبسيط تنفيذها. تقوم هذه الدوال بتغليف أكثر العمليات استخدامًا، مثل: 

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام تاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (شكل المرجع)
- LOOKUP (شكل المتجه)
- MATCH (شكل المتجه)
- MAX
- SUM
- VLOOKUP