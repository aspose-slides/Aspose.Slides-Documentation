---
title: تطبيق صيغ ورقة عمل المخطط في العروض التقديمية باستخدام .NET
linktitle: صيغ ورقة العمل
type: docs
weight: 70
url: /ar/net/chart-worksheet-formulas/
keywords:
- جدول بيانات المخطط
- ورقة عمل المخطط
- صيغة المخطط
- صيغة ورقة العمل
- صيغة جدول البيانات
- مصدر البيانات
- ثابت منطقي
- ثابت رقمي
- ثابت نصي
- ثابت خطأ
- ثابت حسابي
- عامل مقارنة
- نمط A1
- نمط R1C1
- دالة معرفة مسبقًا
- PowerPoint
- عرض تقديمي
- .NET
- C#
- Aspose.Slides
description: "تطبيق صيغ بنمط Excel في Aspose.Slides لأوراق عمل المخطط في .NET وتلقيم التقارير عبر ملفات PPT و PPTX."
---

## **حول صيغة جدول بيانات المخطط في العرض التقديمي**
**Chart spreadsheet** (أو ورقة عمل المخطط) في العرض التقديمي هي مصدر بيانات المخطط. يحتوي جدول بيانات المخطط على البيانات التي يتم تمثيلها على المخطط بصورة رسومية. عندما تنشئ مخططًا في PowerPoint، يتم إنشاء ورقة العمل المرتبطة بهذا المخطط تلقائيًا أيضًا. يتم إنشاء ورقة عمل المخطط لجميع أنواع المخططات: مخطط خط، مخطط شريطي، مخطط شعاعي، مخطط دائري، إلخ. لعرض جدول بيانات المخطط في PowerPoint يجب النقر مزدوجًا على المخطط:

![todo:image_alt_text](chart-worksheet-formulas_1.png)

جدول بيانات المخطط يحتوي على أسماء عناصر المخطط (اسم الفئة: *Category1*، اسم السلسلة) وجدول بالبيانات الرقمية المناسبة لهذه الفئات والسلاسل. بشكل افتراضي، عندما تنشئ مخططًا جديدًا – يتم تعيين بيانات جدول البيانات إلى البيانات الافتراضية. ثم يمكنك تعديل بيانات جدول البيانات في ورقة العمل يدويًا.

عادةً ما يمثل المخطط بيانات معقدة (مثل المحللين الماليين أو العلماء)، حيث تحتوي الخلايا على قيم محسوبة من خلايا أخرى أو من بيانات ديناميكية أخرى. حساب قيمة الخلية يدويًا وتثبيتها داخل الخلية يجعل من الصعب تعديلها في المستقبل. إذا قمت بتغيير قيمة خلية معينة، سيتطلب تحديث جميع الخلايا المعتمدة عليها أيضًا. علاوةً على ذلك، قد تعتمد بيانات الجداول على بيانات جداول أخرى، مما يخلق مخطط بيانات عرض تقديمي معقد يحتاج إلى تحديث سهل ومرن.

**Chart spreadsheet formula** في العرض التقديمي هي تعبير لحساب وتحديث بيانات جدول بيانات المخطط تلقائيًا. تحدد صيغة جدول البيانات منطق حساب البيانات لخلية معينة أو مجموعة خلايا. صيغة جدول البيانات هي صيغة رياضية أو منطقية تستخدم: مراجع خلايا، دوال رياضية، عوامل منطقية، عوامل حسابية، دوال تحويل، ثوابت نصية، إلخ. يتم كتابة تعريف الصيغة داخل خلية، ولا تحتوي هذه الخلية على قيمة بسيطة. تحسب صيغة جدول البيانات القيمة وتعيدها، ثم تُعطى هذه القيمة للخلية. صيغ جدول بيانات المخطط في العروض التقديمية هي نفسها صيغ Excel، وتدعم نفس الدوال الافتراضية والعوامل والثوابت لتطبيقها.

في [**Aspose.Slides**](https://products.aspose.com/slides/net/) يتم تمثيل جدول بيانات المخطط باستخدام خاصية 
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdata/properties/chartdataworkbook) من النوع 
[**IChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdataworkbook). 
يمكن تعيين صيغة جدول البيانات وتغييرها باستخدام خاصية 
[**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula). 
الوظائف المدعومة للصيغ في Aspose.Slides هي:

- الثوابت المنطقية
- الثوابت الرقمية
- الثوابت النصية
- ثوابت الأخطاء
- عوامل حسابية
- عوامل مقارنة
- مراجع خلايا بنمط A1
- مراجع خلايا بنمط R1C1
- دوال معرفة مسبقًا

عادةً ما تخزن جداول البيانات قيم الصيغ المحسوبة الأخيرة. إذا لم تتغير بيانات المخطط بعد تحميل العرض التقديمي – تُعيد خاصية **IChartDataCell.Value** تلك القيم عند القراءة. ولكن إذا تم تعديل بيانات جدول البيانات، عند قراءة خاصية **ChartDataCell.Value** يتم إثارة استثناء **CellUnsupportedDataException** للصيغ غير المدعومة. يحدث هذا لأن الصيغ التي يتم تحليلها بنجاح تُحدِّد تبعيات الخلايا وتتحقق من صحة القيم الأخيرة. أما إذا لم يُستطع تحليل الصيغة، لا يمكن ضمان صحة قيمة الخلية.

## **إضافة صيغة جدول بيانات المخطط إلى العرض التقديمي**
أولًا، أضف مخططًا يحتوي على بعض البيانات النموذجية إلى الشريحة الأولى من عرض تقديمي جديد باستخدام 
[IShapeCollection.Shapes.AddChart](https://reference.aspose.com/slides/net/aspose.slides.ishapecollection/addchart/methods/1). 
يتم إنشاء ورقة عمل المخطط تلقائيًا ويمكن الوصول إليها عبر خاصية 
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdata/properties/chartdataworkbook):
``` csharp
using (var presentation = new Presentation())
{
    IChart chart = presentation.Slides[0].Shapes.AddChart(ChartType.ClusteredColumn, 150, 150, 500, 300);
    IChartDataWorkbook workbook = chart.ChartData.ChartDataWorkbook;
    // ...
}
```


لنكتب بعض القيم في الخلايا باستخدام خاصية 
[**IChartDataCell.Value**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/value) من نوع **Object**، مما يعني أنه يمكنك تعيين أي قيمة لهذه الخاصية:
``` csharp

workbook.GetCell(0, "F2").Value = -2.5;

workbook.GetCell(0, "G3").Value = 6.3;

workbook.GetCell(0, "H4").Value = 3;

```


الآن لكتابة صيغة إلى الخلية، يمكنك استخدام خاصية 
[**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula):
``` csharp
workbook.GetCell(0, "B2").Formula = "F2+G3+H4+1";
```


*ملحوظة*: خاصية [**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula) تُستخدم لتعيين مراجع خلايا بنمط A1.

لتعيين مرجع خلايا بنمط [R1C1Formula](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/r1c1formula)، يمكنك استخدام خاصية 
[**IChartDataCell.R1C1Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/r1c1formula):
``` csharp
workbook.GetCell(0, "C2").R1C1Formula = "R[1]C[4]/R[2]C[5]";
```


ثم استخدم طريقة 
[**IChartDataWorkbook.CalculateFormulas**](https://reference.aspose.com/slides/net/aspose.slides.charts/chartdataworkbook/methods/calculateformulas) لحساب جميع الصيغ داخل دفتر العمل وتحديث قيم الخلايا المقابلة:
``` csharp
workbook.CalculateFormulas();

object value1 = workbook.GetCell(0, "B2"); // 7.8

object value2 = workbook.GetCell(0, "C2"); // 2.1

```


## **الثوابت المنطقية**
يمكنك استخدام الثوابت المنطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:

## **الثوابت الرقمية**
يمكن استخدام الأرقام بصيغ عادية أو علمية لإنشاء صيغ جدول بيانات المخطط:

## **الثوابت النصية**
الثابت النصي (أو الحرفي) هو قيمة محددة تُستخدم كما هي ولا تتغير. قد تكون الثوابت النصية: تواريخ، نصوص، أرقام، إلخ:

## **ثوابت الأخطاء**
في بعض الأحيان لا يمكن حساب النتيجة عبر الصيغة. في هذه الحالة يُظهر رمز الخطأ في الخلية بدلاً من قيمتها. لكل نوع من الأخطاء رمز محدد:

- #DIV/0! – تحاول الصيغة القسمة على الصفر.
- #GETTING_DATA – قد يُظهر على الخلية بينما لا يزال قيمتها تُحسب.
- #N/A – المعلومات مفقودة أو غير متوفرة. قد تكون الأسباب: الخلايا المستخدمة في الصيغة فارغة، وجود مسافة زائدة، خطأ إملائي، إلخ.
- #NAME? – لا يمكن العثور على خلية أو كائن صيغة معين باسمه.
- #NULL! – قد يظهر عندما يكون هناك خطأ في الصيغة، مثل (,) أو وجود مسافة بدلاً من النقطتين (:).
- #NUM! – الرقم في الصيغة قد يكون غير صالح، طويل جدًا أو صغير جدًا، إلخ.
- #REF! – مرجع خلية غير صالح.
- #VALUE! – نوع قيمة غير متوقع. على سبيل المثال، قيمة نصية تم وضعها في خلية رقمية.

## **العوامل الحسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة عمل المخطط:

|**العامل**|**المعنى**|**مثال**|
| :- | :- | :- |
|+ (علامة زائد)|جمع أو زائد أحادي|2 + 3|
|- (علامة ناقص)|طرح أو سالب|2 - 3<br>-3|
|* (نجمية)|ضرب|2 * 3|
|/ (شرطة مائلة)|قسمة|2 / 3|
|% (نسبة مئوية)|نسبة مئوية|30%|
|^ (رفع أس)|أس|2 ^ 3|

*ملحوظة*: لتغيير ترتيب التقييم، ضع الجزء الذي تريد حسابه أولاً بين أقواس.

## **العوامل المقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عند مقارنة قيمتين بهذه العوامل يكون الناتج قيمة منطقية إما *TRUE* أو *FALSE*:

|**العامل**|**المعنى**|**مثال**|
| :- | :- | :- |
|= (علامة مساواة)|مساوي لـ|A2 = 3|
|<> (علامة عدم مساواة)|ليس مساويًا لـ|A2 <> 3|
|> (علامة أكبر من)|أكبر من|A2 > 3|
|>= (علامة أكبر من أو يساوي)|أكبر من أو يساوي|A2 >= 3|
|< (علامة أصغر من)|أصغر من|A2 < 3|
|<= (علامة أصغر من أو يساوي)|أصغر من أو يساوي|A2 <= 3|

## **مراجع خلايا بنمط A1**
**مراجع خلايا بنمط A1** تُستخدم في أوراق العمل التي يكون العمود فيها معرفًا بحرف (مثل "*A*") والصف معرفًا برقم (مثل "*1*"). يمكن استخدام مراجع خلايا بنمط A1 بالشكل التالي:

|**مرجع الخلية**|**مثال**| | |
| :- | :- | :- | :- |
| |مطلق|نسبي|مختلط|
|خلية|$A$2|A2|<p>A$2</p><p>$A2</p>|
|صف|$2:$2|2:2|-|
|عمود|$A:$A|A:A|-|
|نطاق|$A$2:$C$4|A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|

فيما يلي مثال على استخدام مرجع خلية بنمط A1 في الصيغة:

## **مراجع خلايا بنمط R1C1**
**مراجع خلايا بنمط R1C1** تُستخدم في أوراق العمل التي يكون لكلٍ من الصف والعمود معرفًا رقميًا. يمكن استخدام مراجع خلايا بنمط R1C1 بالشكل التالي:

|**مرجع الخلية**|**مثال**| | |
| :- | :- | :- | :- |
| |مطلق|نسبي|مختلط|
|خلية|R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف|R2|R[2]|-|
|عمود|C3|C[3]|-|
|نطاق|R2C3:R5C7|R[2]C[3]:R[5]C[7]|R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|

فيما يلي مثال على استخدام مرجع خلية بنمط A1 في الصيغة:

## **الدوال المعرفة مسبقًا**
هناك دوال معرفة مسبقًا يمكن استخدامها في الصيغ لتبسيط تنفيذها. هذه الدوال تُغلف أكثر العمليات شيوعًا، مثل:

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام تاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (صيغة المرجع)
- LOOKUP (صيغة المتجه)
- MATCH (صيغة المتجه)
- MAX
- SUM
- VLOOKUP

## **الأسئلة المتكررة**

**هل يتم دعم ملفات Excel الخارجية كمصدر بيانات لمخطط يحتوي على صيغ؟**

نعم. تدعم Aspose.Slides دفاتر عمل خارجية كمصدر بيانات [للمخطط](https://reference.aspose.com/slides/net/aspose.slides.charts/chartdatasourcetype/)، مما يتيح لك استخدام صيغ من ملف XLSX خارج العرض التقديمي.

**هل يمكن لصيغ المخطط الإشارة إلى أوراق داخل نفس دفتر العمل باسم الورقة؟**

نعم. تتبع الصيغ نموذج المراجع القياسي في Excel، لذا يمكنك الإشارة إلى أوراق أخرى داخل نفس دفتر العمل أو دفتر عمل خارجي. للمراجع الخارجية، ضمن المسار واسم دفتر العمل باستخدام صيغة Excel.