---
title: صيغ ورقة عمل المخطط
type: docs
weight: 70
url: /ar/net/chart-worksheet-formulas/
keywords: "جدول بيانات المخطط, صيغة المخطط, عرض تقديمي PowerPoint, C#, Csharp, Aspose.Slides لـ .NET"
description: "جدول بيانات المخطط والصيغة في عرض تقديمي PowerPoint باستخدام C# أو .NET"
---

## **حول صيغة جدول البيانات الخاص بالمخطط في العرض التقديمي**
**جدول البيانات الخاص بالمخطط** (أو ورقة عمل المخطط) في العرض التقديمي هو مصدر البيانات للمخطط. يحتوي جدول البيانات الخاص بالمخطط على البيانات التي يتم تمثيلها على المخطط بصورة رسومية. عند إنشاء مخطط في PowerPoint يتم إنشاء ورقة العمل المرتبطة بهذا المخطط تلقائيًا أيضًا. يتم إنشاء ورقة عمل المخطط لجميع أنواع المخططات: مخطط خط، مخطط شريط، مخطط شرنق مشع، مخطط دائري، إلخ. لرؤية جدول البيانات الخاص بالمخطط في PowerPoint يجب النقر المزدوج على المخطط:

![todo:image_alt_text](chart-worksheet-formulas_1.png)

جدول البيانات الخاص بالمخطط يحتوي على أسماء عناصر المخطط (اسم الفئة: *Category1*، اسم السلسلة) وجدول بالبيانات الرقمية المناسبة لهذه الفئات والسلاسل. بشكل افتراضي، عند إنشاء مخطط جديد تُضبط بيانات جدول البيانات الخاصة بالمخطط بالبيانات الافتراضية. ثم يمكنك تعديل بيانات جدول البيانات في ورقة العمل يدويًا.

عادةً ما يمثل المخطط بيانات معقدة (مثل محللي المال، محللي العلوم)، حيث توجد خلايا يتم حسابها من القيم في خلايا أخرى أو من بيانات ديناميكية أخرى. حساب قيمة الخلية يدويًا وتثبيتها داخل الخلية يجعل تعديلها في المستقبل صعبًا. إذا قمت بتغيير قيمة خلية معينة، سيتطلب تحديث جميع الخلايا المعتمدة عليها. علاوةً على ذلك قد تعتمد بيانات الجداول على بيانات جداول أخرى، مما يخلق مخطط بيانات عرض تقديمي معقد يحتاج إلى تحديث سهل ومرن.

**صيغة جدول البيانات الخاص بالمخطط** في العرض التقديمي هي تعبير لحساب وتحديث بيانات جدول البيانات الخاص بالمخطط تلقائيًا. تُعرّف صيغة جدول البيانات منطق حساب البيانات لخلية معينة أو مجموعة خلايا. صيغة جدول البيانات هي صيغة رياضية أو منطقية، تستخدم: مراجع خلايا، وظائف رياضية، عوامل منطقية، عوامل حسابية، وظائف تحويل، ثابت نصي، إلخ. يتم كتابة تعريف الصيغة داخل الخلية، ولا تحتوي هذه الخلية على قيمة بسيطة. تحسب صيغة جدول البيانات القيمة وتعيدها، ثم تُعيّن هذه القيمة إلى الخلية. صيغ جدول البيانات في العروض التقديمية هي في الواقع نفس صيغ Excel، وتدعم نفس الدوال الافتراضية والعوامل والثوابت لتطبيقها.

في [**Aspose.Slides**](https://products.aspose.com/slides/net/) يُمثَّل جدول البيانات الخاص بالمخطط باستخدام خاصية
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdata/properties/chartdataworkbook) من النوع
[**IChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdataworkbook). يمكن تعيين صيغة جدول البيانات وتغييرها باستخدام خاصية
[**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula). الوظائف التالية مدعومة للصيغ في Aspose.Slides:

- ثوابت منطقية
- ثوابت رقمية
- ثوابت نصية
- ثوابت خطأ
- عوامل حسابية
- عوامل مقارنة
- مراجع خلايا بنمط A1
- مراجع خلايا بنمط R1C1
- دوال معرفة مسبقًا

عادةً ما تخزن جداول البيانات القيم الأخيرة المحسوبة للصيغ. إذا لم تتغير بيانات المخطط بعد تحميل العرض التقديمي، فإن خاصية **IChartDataCell.Value** تُعيد تلك القيم عند القراءة. ولكن، إذا تم تغيير بيانات جدول البيانات، فإن قراءة خاصية **ChartDataCell.Value** تُطلق استثناء **CellUnsupportedDataException** للصيغ غير المدعومة. يحدث ذلك لأنه عند تحليل الصيغ بنجاح يتم تحديد اعتماديات الخلايا وصحة القيم الأخيرة. أما إذا تعذّر تحليل الصيغة، لا يمكن ضمان صحة قيمة الخلية.

## **إضافة صيغة جدول البيانات الخاص بالمخطط إلى العرض التقديمي**
أولاً، أضف مخططًا يحتوي على بعض البيانات النموذجية إلى الشريحة الأولى من عرض تقديمي جديد باستخدام
[IShapeCollection.Shapes.AddChart](https://reference.aspose.com/slides/net/aspose.slides.ishapecollection/addchart/methods/1). يتم إنشاء ورقة العمل الخاصة بالمخطط تلقائيًا ويمكن الوصول إليها عبر خاصية
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdata/properties/chartdataworkbook):
``` csharp
using (var presentation = new Presentation())
{
    IChart chart = presentation.Slides[0].Shapes.AddChart(ChartType.ClusteredColumn, 150, 150, 500, 300);
    IChartDataWorkbook workbook = chart.ChartData.ChartDataWorkbook;
    // ...
}
```


لنكتب بعض القيم في الخلايا باستخدام خاصية
[**IChartDataCell.Value**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/value) من النوع **Object**، مما يعني أنه يمكنك تعيين أي قيمة لهذه الخاصية:
``` csharp
workbook.GetCell(0, "F2").Value = -2.5;
workbook.GetCell(0, "G3").Value = 6.3;
workbook.GetCell(0, "H4").Value = 3;
```


الآن لكتابة صيغة إلى الخلية، يمكنك استخدام خاصية
[**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula):
``` csharp
workbook.GetCell(0, "B2").Formula = "F2+G3+H4+1";
```


*ملاحظة*: خاصية [**IChartDataCell.Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/formula) تُستخدم لتعيين مراجع خلايا بنمط A1.

لتعيين مرجع خلية بنمط [R1C1Formula](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/r1c1formula)، يمكنك استخدام خاصية
[**IChartDataCell.R1C1Formula**](https://reference.aspose.com/slides/net/aspose.slides.charts/ichartdatacell/properties/r1c1formula):
``` csharp
workbook.GetCell(0, "C2").R1C1Formula = "R[1]C[4]/R[2]C[5]";
```


ثم استخدم طريقة
[**IChartDataWorkbook.CalculateFormulas**](https://reference.aspose.com/slides/net/aspose.slides.charts/chartdataworkbook/methods/calculateformulas) لحساب جميع الصيغ داخل دفتر العمل وتحديث قيم الخلايا المقابلة:
``` csharp
workbook.CalculateFormulas();

object value1 = workbook.GetCell(0, "B2"); // 7.8

object value2 = workbook.GetCell(0, "C2"); // 2.1

```


## **ثوابت منطقية**
يمكنك استخدام ثوابت منطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:

## **ثوابت رقمية**
يمكن استخدام الأرقام بصيغة عادية أو علمية لإنشاء صيغة جدول بيانات المخطط:

## **ثوابت نصية**
الثابت النصي (أو الحرفي) هو قيمة محددة تُستخدم كما هي ولا تتغير. قد تكون الثوابت النصية: تواريخ، نصوص، أرقام، إلخ:

## **ثوابت خطأ**
أحيانًا لا يمكن حساب النتيجة باستخدام الصيغة. في هذه الحالة يُعرض رمز الخطأ في الخلية بدلاً من قيمتها. كل نوع من الأخطاء له رمز محدد:

- #DIV/0! - الصيغة تحاول القسمة على الصفر.
- #GETTING_DATA - قد يُعرض على الخلية بينما لا تزال قيمتها تُحسب.
- #N/A - المعلومات مفقودة أو غير متاحة. قد يكون السبب: الخلايا المستخدمة في الصيغة فارغة، أو وجود مساحة إضافية، أو خطأ إملائي، إلخ.
- #NAME? - لا يمكن العثور على خلية معينة أو كائن صيغة آخر بالاسم.
- #NULL! - قد يظهر عندما يكون هناك خطأ في الصيغة، مثل: (,) أو مساحة بدلاً من نقطتين (:).
- #NUM! - الرقم في الصيغة قد يكون غير صالح، طويل جدًا أو صغير جدًا، إلخ.
- #REF! - إشارة خلية غير صالحة.
- #VALUE! - نوع قيمة غير متوقع. مثال: قيمة نصية في خلية رقمية.

## **العوامل الحسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة عمل المخطط:

|**المعامل**|**المعنى**|**مثال**|
| :- | :- | :- |
|+ (علامة زائد)|الإضافة أو الجمع الأحادي|2 + 3|
|- (علامة ناقص)|الطرح أو السالب الأحادي|2 - 3<br>-3|
|* (نجمة)|الضرب|2 * 3|
|/ (شرطة مائلة)|القسمة|2 / 3|
|% (علامة النسبة المئوية)|النسبة المئوية|30%|
|^ (علامة أcaret)|الرفع إلى القوة|2 ^ 3|

*ملاحظة*: لتغيير ترتيب التقييم، ضع الجزء المراد حسابه أولًا بين أقواس.

## **العوامل المقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عندما تُقارن قيمتين بهذه العوامل يكون الناتج قيمة منطقية إما *TRUE* أو FALSE:

|**المعامل**|**المعنى**|**المعنى**|
| :- | :- | :- |
|= (علامة مساواة)|مساوية لـ|A2 = 3|
|<> (علامة عدم مساواة)|ليست مساوية لـ|A2 <> 3|
|> (علامة أكبر من)|أكبر من|A2 > 3|
|>= (علامة أكبر من أو مساوية)|أكبر من أو مساوية لـ|A2 >= 3|
|< (علامة أصغر من)|أصغر من|A2 < 3|
|<= (علامة أصغر من أو مساوية)|أصغر من أو مساوية لـ|A2 <= 3|

## **مراجع خلايا بنمط A1**
**مراجع خلايا بنمط A1** تُستخدم في أوراق العمل حيث يُعرّف العمود بحرف (مثال "*A*") والصف يُعرّف رقماً (مثال "*1*"). يمكن استخدام مراجع خلايا بنمط A1 بالشكل التالي:

|**مرجع الخلية**|**مثال**|**مطلق**|**نسبي**|**مختلط**|
| :- | :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|$A$2|A2|<p>A$2</p><p>$A2</p>|
|صف|$2:$2|2:2|-|
|عمود|$A:$A|A:A|-|
|نطاق|$A$2:$C$4|A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|

إليك مثالًا على كيفية استخدام مرجع خلية بنمط A1 في صيغة:

## **مراجع خلايا بنمط R1C1**
**مراجع خلايا بنمط R1C1** تُستخدم في أوراق العمل حيث يُعرّف كل من الصف والعمود برقمان. يمكن استخدام مراجع خلايا بنمط R1C1 بالشكل التالي:

|**مرجع الخلية**|**مثال**|**مطلق**|**نسبي**|**مختلط**|
| :- | :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف|R2|R[2]|-|
|عمود|C3|C[3]|-|
|نطاق|R2C3:R5C7|R[2]C[3]:R[5]C[7]|R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|

إليك مثالًا على كيفية استخدام مرجع خلية بنمط R1C1 في صيغة:

## **الدوال المعرفة مسبقًا**
هناك دوال معرفة مسبقًا يمكن استخدامها في الصيغ لتبسيط تنفيذها. هذه الدوال تغطي أكثر العمليات شيوعًا، مثل:

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام تاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (نموذج مرجع)
- LOOKUP (نموذج متجه)
- MATCH (نموذج متجه)
- MAX
- SUM
- VLOOKUP

## **الأسئلة المتكررة**

**هل تدعم ملفات Excel الخارجية كمصدر بيانات لمخطط يحتوي على صيغ؟**

نعم. يدعم Aspose.Slides ملفات العمل الخارجية كمصدر بيانات للمخطط، مما يتيح لك استخدام صيغ من ملف XLSX خارج العرض التقديمي.

**هل يمكن لصيغ المخطط الإشارة إلى أوراق ضمن نفس دفتر العمل باستخدام اسم الورقة؟**

نعم. تتبع الصيغ نموذج المرجعية القياسي في Excel، لذا يمكنك الإشارة إلى أوراق أخرى داخل نفس دفتر العمل أو دفتر عمل خارجي. للمراجع الخارجية، قم بتضمين المسار واسم دفتر العمل باستخدام صيغة Excel.