---
title: صيغة جدول البيانات البيانية
type: docs
weight: 70
url: /python-net/chart-worksheet-formulas/
keywords: "جدول بيانات الرسم البياني، صيغة الرسم البياني، عرض PowerPoint، بايثون، Aspose.Slides لـ بايثون عبر .NET"
description: "جدول بيانات الرسم البياني وصيغة في عرض PowerPoint باستخدام بايثون"
---


## **حول صيغة جدول البيانات البيانية في العرض**
**جدول بيانات الرسم البياني** (أو ورقة عمل الرسم البياني) في العرض هو مصدر البيانات للرسم البياني. يحتوي جدول بيانات الرسم البياني على بيانات تمثل على الرسم البياني بشكل رسومي. عند إنشاء رسم بياني في PowerPoint، يتم أيضًا إنشاء ورقة العمل المرتبطة بهذا الرسم البياني تلقائيًا. تتوفر ورقة العمل الخاصة بالرسم البياني لجميع أنواع الرسوم البيانية: الرسم البياني الخطي، الرسم البياني الشريطي، الرسم البياني الشمسي، الرسم البياني الدائري، إلخ. لرؤية جدول بيانات الرسم البياني في PowerPoint، يجب النقر نقرًا مزدوجًا على الرسم البياني:

![todo:image_alt_text](chart-worksheet-formulas_1.png)



يحتوي جدول بيانات الرسم البياني على أسماء عناصر الرسم البياني (اسم الفئة: *الفئة1*، اسم السلسلة) وجدول ببيانات رقمية مناسبة لهذه الفئات والسلاسل. بشكل افتراضي، عند إنشاء رسم بياني جديد - يتم إعداد بيانات جدول بيانات الرسم البياني مع البيانات الافتراضية. بعد ذلك، يمكنك تغيير بيانات جدول البيانات في ورقة العمل يدويًا.

عادةً ما يمثل الرسم البياني بيانات معقدة (مثل المحللين الماليين، والمحليين العلميين)، حيث تحتوي الخلايا على قيم محسوبة من القيم في خلايا أخرى أو من بيانات ديناميكية أخرى. حساب قيمة خلية يدويًا وترميزها بشكل ثابت في الخلية، يجعل من الصعب تغييرها في المستقبل. إذا قمت بتغيير قيمة خلية معينة، فإن جميع الخلايا المعتمدة عليها ستحتاج أيضًا إلى التحديث. علاوة على ذلك، قد تعتمد بيانات الجدول على بيانات من جداول أخرى، مما يخلق مخطط بيانات تقديمية معقدة يتطلب تحديثه بسهولة ومرونة.

**صيغة جدول بيانات الرسم البياني** في العرض هي تعبير لحساب وتحديث بيانات جدول بيانات الرسم البياني تلقائيًا. تحدد صيغة جدول البيانات منطق حساب البيانات لخلية معينة أو مجموعة من الخلايا. صيغة جدول البيانات هي صيغة رياضية أو صيغة منطقيّة، تستخدم: مراجع الخلايا، وظائف رياضية، عوامل منطقية، عوامل حسابية، وظائف تحويل، ثوابت سلسلة، إلخ. يتم كتابة تعريف الصيغة في خلية، وهذه الخلية لا تحتوي على قيمة بسيطة. تقوم صيغة جدول البيانات بحساب القيمة وإرجاعها، ثم يتم تعيين هذه القيمة للخلية. صيغة جدول بيانات الرسم البياني في العروض هي في الواقع نفسها كصيغ Excel، وتدعم نفس الوظائف والعوامل والثوابت الافتراضية في تنفيذها.

في [**Aspose.Slides**](https://products.aspose.com/slides/python-net/) يتم تمثيل جدول بيانات الرسم البياني مع 
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdata/) خاصية نوع 
[**IChartDataWorkbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdataworkbook/). 
يمكن تعيين وتغيير صيغة جدول البيانات مع 
[**formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) خاصية. 
الدالة التالية مدعومة للصيغ في Aspose.Slides:

- ثوابت منطقية
- ثوابت عددية
- ثوابت سلسلة
- ثوابت خطأ
- عوامل رياضية
- عوامل مقارنة
- مراجع خلايا على نمط A1
- مراجع خلايا على نمط R1C1
- وظائف محددة مسبقًا



عادةً ما تخزن جداول البيانات آخر قيم محسوبة للصيغ. إذا لم تتغير بيانات الرسم البياني بعد تحميل العرض - فإن خاصية **IChartDataCell.Value** تعيد تلك القيم عند القراءة. ولكن، إذا تم تغيير بيانات جدول البيانات، عند القراءة فإن خاصية **ChartDataCell.Value** ترمي استثناء **CellUnsupportedDataException** للصيغ غير المدعومة. يحدث هذا لأنه عند بنجاح تحليله، يتم تحديد اعتمادات الخلايا وتحديد صحة القيم الأخيرة. لكن، إذا لم يمكن تحليل الصيغة، فلا يمكن ضمان صحة قيمة الخلية.
## **إضافة صيغة جدول بيانات الرسم البياني إلى العرض**
أولاً، أضف رسمًا بيانيًا مع بعض البيانات النموذجية إلى الشريحة الأولى من عرض تقديمي جديد باستخدام 
[add_chart](https://reference.aspose.com/slides/python-net/aspose.slides/ishapecollection/). 
تتم إنشاء ورقة العمل الخاصة بالرسم البياني تلقائيًا ويمكن الوصول إليها باستخدام 
[**chart_data_workbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdata/) الخاصية:



```py
import aspose.slides.charts as charts
import aspose.slides as slides

with slides.Presentation() as presentation:
    chart = presentation.slides[0].shapes.add_chart(charts.ChartType.CLUSTERED_COLUMN, 150, 150, 500, 300)
    workbook = chart.chart_data.chart_data_workbook
    # ...
```



لنكتب بعض القيم في الخلايا باستخدام 
[**value**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) الخاصية 
لنمط **Object**، مما يعني أنه يمكنك تعيين أي قيمة إلى الخاصية:



```py
    workbook.get_cell(0, "F2").value = -2.5
    workbook.get_cell(0, "G3").value = 6.3
    workbook.get_cell(0, "H4").value = 3
```



الآن لكتابة الصيغة في الخلية، يمكنك استخدام 
[**formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) الخاصية:

```py
    workbook.get_cell(0, "B2").formula = "F2+G3+H4+1"
```

*ملاحظة*: يتم استخدام خاصية [**IChartDataCell.Formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) لتعيين مراجع الخلايا على نمط A1. 



لتعيين الإشارة المرجعية في صيغة [r1c1_formula](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) ، يمكنك استخدام خاصية 
[**r1c1_formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/):

```py
    workbook.get_cell(0, "C2").r1c1_formula = "R[1]C[4]/R[2]C[5]"
```

ثم استخدم الطريقة [**calculate_formulas**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/chartdataworkbook/) لحساب جميع الصيغ داخل دفتر العمل وتحديث قيم الخلايا المقابلة:



```py
    workbook.calculate_formulas()
    print(workbook.get_cell(0, "B2").value) # 7.8
    print(workbook.get_cell(0, "C2").value) # 2.1
```


## **ثوابت منطقية**
يمكنك استخدام الثوابت المنطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:




## **ثوابت عددية**
يمكن استخدام الأرقام في التدوين العادي أو العلمي لإنشاء صيغة جدول بيانات الرسم البياني:




## **ثوابت سلسلة**
الثابت السلسلي (أو الأدبي) هو قيمة محددة تستخدم كما هي ولا تتغير. يمكن أن تكون الثوابت السلسلية: تواريخ، نصوص، أرقام، إلخ:




## **ثوابت خطأ**
في بعض الأحيان ليس من الممكن حساب النتيجة بواسطة الصيغة. في هذه الحالة، يتم عرض رمز الخطأ في الخلية بدلاً من قيمتها. لكل نوع من الخطأ رمز محدد:

- #DIV/0! - تحاول الصيغة القسمة على الصفر.
- #GETTING_DATA - قد يظهر في خلية، بينما لا تزال قيمتها قيد الحساب.
- #N/A - المعلومات مفقودة أو غير متوفرة. بعض الأسباب يمكن أن تكون: الخلايا المستخدمة في الصيغة فارغة، وجود مسافة إضافية، خطأ في الكتابة، إلخ.
- #NAME? - لا يمكن العثور على خلية معينة أو كائنات صيغة أخرى باسمها. 
- #NULL! - قد يظهر عندما يكون هناك خطأ في الصيغة، مثل: (,) أو استخدام مسافة بدلاً من النقطتين (:).
- #NUM! - قد تكون القيمة العددية في الصيغة غير صالحة، طويلة جدًا أو صغيرة جدًا، إلخ.
- #REF! - مرجع خلية غير صالح.
- #VALUE! - نوع قيمة غير متوقع. على سبيل المثال، تم تعيين قيمة سلسلة إلى خلية عددية.




## **عوامل حسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة العمل للرسم البياني:



|**العامل** |**المعنى** |**مثال**|
| :- | :- | :- |
|+ (علامة الجمع) |إaddition أو جمع أحادي|2 + 3|
|- (علامة الطرح) |طرح أو نفي |2 - 3<br>-3|
|* (نجمة)|ضرب |2 * 3|
|/ (شرط أمامي)|قسمة |2 / 3|
|% (علامة النسبة) |نسبة |30%|
|^ (علامة الأس) |رفع للقوة |2 ^ 3|


*ملاحظة*: لتغيير ترتيب التقييم، ضع بين قوسين الجزء من الصيغة المراد حسابه أولاً.


## **عوامل مقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عند المقارنة بين قيمتين باستخدام هذه العوامل، تكون النتيجة قيمة منطقية إما *TRUE* أو FALSE:



|**العامل** |**المعنى** |**المعنى** |
| :- | :- | :- |
|= (علامة المساواة) |تساوي |A2 = 3|
|<> (علامة عدم المساواة) |لا تساوي|A2 <> 3|
|> (علامة أكبر من) |أكبر من|A2 > 3|
|>= (علامة أكبر من أو يساوي)|أكبر من أو يساوي|A2 >= 3|
|< (علامة أقل من)|أقل من|A2 < 3|
|<= (علامة أقل من أو يساوي)|أقل من أو يساوي|A2 <= 3|

## **مراجع خلايا على نمط A1**
**مراجع خلايا على نمط A1** تستخدم لورقات العمل، حيث يحتوي العمود على معرف حرف (مثل "*A*") والصف يحتوي على معرف رقمي (مثل "*1*"). يمكن استخدام مراجع خلايا على نمط A1 بالطريقة التالية:



|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق |نسبي |مختلط|
|خلية |$A$2 |A2|<p>A$2</p><p>$A2</p>|
|صف |$2:$2 |2:2 |-|
|عمود |$A:$A |A:A |-|
|نطاق |$A$2:$C$4 |A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|


إليك مثال حول كيفية استخدام مرجع خلية على نمط A1 في صيغة:




## **مراجع خلايا على نمط R1C1**
**مراجع خلايا على نمط R1C1** تستخدم لورقات العمل، حيث يحتوي كل من الصف والعمود على معرف رقمي. يمكن استخدام مراجع خلايا على نمط R1C1 بالطريقة التالية:



|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق |نسبي |مختلط|
|خلية |R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف |R2|R[2]|-|
|عمود |C3|C[3]|-|
|نطاق |R2C3:R5C7|R[2]C[3]:R[5]C[7] |R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|


إليك مثال حول كيفية استخدام مرجع خلية على نمط A1 في صيغة:




## **وظائف محددة مسبقًا**
هناك وظائف محددة مسبقًا، يمكن استخدامها في الصيغ لتبسيط تنفيذها. تقوم هذه الوظائف بتجميع العمليات الأكثر شيوعًا المستخدمة، مثل: 

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام تاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (شكل مرجعي)
- LOOKUP (شكل متجه)
- MATCH (شكل متجه)
- MAX
- SUM
- VLOOKUP