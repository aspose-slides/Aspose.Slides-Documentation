---
title: تطبيق صيغ ورقة عمل المخطط في العروض التقديمية باستخدام بايثون
linktitle: صيغ ورقة العمل
type: docs
weight: 70
url: /ar/python-net/chart-worksheet-formulas/
keywords:
- مخطط جدول بيانات
- مخطط ورقة عمل
- صيغ المخطط
- صيغة ورقة العمل
- صيغة جدول البيانات
- مصدر البيانات
- ثابت منطقي
- ثابت رقمي
- ثابت سلسلة
- ثابت خطأ
- ثابت حسابي
- عامل مقارنة
- نمط A1
- نمط R1C1
- دالة مسبقة التعريف
- PowerPoint
- OpenDocument
- عرض تقديمي
- Python
- Aspose.Slides
description: "تطبيق صيغ بأسلوب Excel في Aspose.Slides للبايثون عبر .NET لورقات عمل المخطط وتلقائيًا إنشاء تقارير عبر ملفات PPT و PPTX و ODP."
---

## **حول صيغة جدول بيانات المخطط في العروض التقديمية**
**جدول بيانات المخطط** (أو ورقة عمل المخطط) في العرض هو مصدر البيانات للمخطط. يحتوي جدول بيانات المخطط على البيانات التي تُعرض على المخطط بصورة رسومية. عندما تنشئ مخططًا في PowerPoint، يتم إنشاء ورقة العمل المرتبطة بهذا المخطط تلقائيًا أيضًا. تُنشأ ورقة عمل المخطط لجميع أنواع المخططات: مخطط خطي، مخطط شريطي، مخطط شمسية، مخطط دائري، إلخ. لرؤية جدول بيانات المخطط في PowerPoint عليك النقر المزدوج على المخطط:

![todo:image_alt_text](chart-worksheet-formulas_1.png)

يحتوي جدول بيانات المخطط على أسماء عناصر المخطط (اسم الفئة: *Category1*، اسم السلسلة) وجدول بالبيانات الرقمية المتطابقة مع هذه الفئات والسلاسل. بشكل افتراضي، عند إنشاء مخطط جديد تُضبط بيانات جدول بيانات المخطط بالبيانات الافتراضية. ثم يمكنك تعديل بيانات الجدول يدويًا في ورقة العمل.

عادةً ما يمثل المخطط بيانات معقدة (مثل المحللين الماليين أو العلماء)، مع خلايا تُحسب من قيم خلايا أخرى أو من بيانات ديناميكية أخرى. حساب قيمة الخلية يدويًا وتثبيتها في الخلية يجعل تعديلها لاحقًا صعبًا. إذا غيرت قيمة خلية معينة، سيتوجب تحديث جميع الخلايا المعتمدة عليها. علاوةً على ذلك قد تعتمد بيانات الجدول على بيانات جداول أخرى، مما يُنشئ مخطط بيانات عرضًا معقدًا يحتاج إلى تحديث سهل ومرن.

**صيغة جدول بيانات المخطط** في العرض هي تعبير يُحسب ويُحدّث بيانات جدول البيانات تلقائيًا. تُعرّف الصيغة منطق حساب البيانات لخلية معينة أو مجموعة خلايا. الصيغة هي صيغة رياضية أو منطقية تستخدم: مراجع خلايا، دوال رياضية، عوامل منطقية، عوامل حسابية، دوال تحويل، ثوابت نصية، إلخ. تُكتب تعريف الصيغة داخل خلية لا تحتوي على قيمة بسيطة. تحسب صيغة جدول البيانات القيمة وتعيدها، ثم تُعيّن هذه القيمة للخلية. صيغ جداول البيانات في العروض هي نفسها صيغ Excel، وتُدعم نفس الدوال الافتراضية، والعوامل، والثوابت لتطبيقها.

في [**Aspose.Slides**](https://products.aspose.com/slides/python-net/) يُمثَّل جدول بيانات المخطط بالخاصية
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdata/) من النوع
[**IChartDataWorkbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdataworkbook/).
يمكن تعيين الصيغة وتغييرها بالخاصية
[**formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/).
الوظائف المدعومة للصيغ في Aspose.Slides:

- ثوابت منطقية
- ثوابت رقمية
- ثوابت نصية
- ثوابت خطأ
- عوامل حسابية
- عوامل مقارنة
- مراجع خلايا بنمط A1
- مراجع خلايا بنمط R1C1
- دوال مسبقة التعريف

عادةً ما تُخزّن الجداول آخر قيم الصيغ المحسوبة. إذا لم تُغيَّر بيانات المخطط بعد تحميل العرض، تُعيد خاصية **IChartDataCell.Value** تلك القيم عند القراءة. لكن إذا تغيّر بيانات الجدول، تُرمى خاصية **ChartDataCell.Value** استثناء **CellUnsupportedDataException** لل صيغ غير المدعومة. يحدث هذا لأنّه عندما تُحلل الصيغ بنجاح تُحدَّد تبعيات الخلايا وتُتحقق صحة القيم الأخيرة. أما إذا لم تستطع الصيغة التحليل، لا يمكن ضمان صحة قيمة الخلية.

## **إضافة صيغة جدول بيانات المخطط إلى العرض**
أولًا، أضف مخططًا ببيانات نموذجية إلى الشريحة الأولى من عرض جديد باستخدام
[add_chart](https://reference.aspose.com/slides/python-net/aspose.slides/ishapecollection/).
تُنشأ ورقة عمل المخطط تلقائيًا ويمكن الوصول إليها بالخاصية
[**chart_data_workbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdata/):

```py
import aspose.slides.charts as charts
import aspose.slides as slides

with slides.Presentation() as presentation:
    chart = presentation.slides[0].shapes.add_chart(charts.ChartType.CLUSTERED_COLUMN, 150, 150, 500, 300)
    workbook = chart.chart_data.chart_data_workbook
    # ...
```

لنكتب بعض القيم في الخلايا باستخدام الخاصية
[**value**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) من نوع **Object**، مما يعني أنه يمكنك تعيين أي قيمة للخاصية:

```py
    workbook.get_cell(0, "F2").value = -2.5
    workbook.get_cell(0, "G3").value = 6.3
    workbook.get_cell(0, "H4").value = 3
```

الآن لكتابة صيغة في الخلية، يمكنك استخدام الخاصية
[**formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/):

```py
    workbook.get_cell(0, "B2").formula = "F2+G3+H4+1"
```

*ملاحظة*: تُستخدم الخاصية [**IChartDataCell.Formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) لتعيين مراجع خلايا بنمط A1.

لتعيين مرجع خلية بنمط [r1c1_formula](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/)، يمكنك استخدام الخاصية [**r1c1_formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/):

```py
    workbook.get_cell(0, "C2").r1c1_formula = "R[1]C[4]/R[2]C[5]"
```

ثم استخدم طريقة
[**calculate_formulas**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/chartdataworkbook/) لحساب جميع الصيغ داخل دفتر العمل وتحديث قيم الخلايا المقابلة:

```py
    workbook.calculate_formulas()
    print(workbook.get_cell(0, "B2").value) # 7.8
    print(workbook.get_cell(0, "C2").value) # 2.1
```

## **ثوابت منطقية**
يمكنك استخدام الثوابت المنطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:

## **ثوابت رقمية**
يمكن استعمال الأرقام بنظام عادي أو علمي لإنشاء صيغ جدول بيانات المخطط:

## **ثوابت نصية**
الثابت النصي (أو الحرفي) هو قيمة محددة تُستخدم كما هي ولا تتغير. قد تكون الثوابت النصية: تواريخ، نصوص، أرقام، إلخ:

## **ثوابت خطأ**
في بعض الأحيان لا يمكن حساب النتيجة بالصيغة. في هذه الحالة يُظهر رمز الخطأ في الخلية بدلًا من القيمة. لكل نوع من الأخطاء رمز محدد:

- #DIV/0! - تحاول الصيغة القسمة على الصفر.
- #GETTING_DATA - قد يُظهر على الخلية بينما لا تزال قيمتها تُحسب.
- #N/A - المعلومات مفقودة أو غير متاحة. قد يكون السبب: الخلايا المستخدمة في الصيغة فارغة، أو وجود مساحة إضافية، أو خطأ إملائي، إلخ.
- #NAME? - لا يمكن العثور على خلية معينة أو كائن صيغة آخر بالاسم.
- #NULL! - قد يظهر عندما يكون هناك خطأ في الصيغة، مثل: (,) أو مساحة مستخدمة بدلًا من نقطتين (:).
- #NUM! - الرقم في الصيغة قد يكون غير صالح، طويل جدًا أو قصير جدًا، إلخ.
- #REF! - مرجع خلية غير صالح.
- #VALUE! - نوع قيمة غير متوقع. مثال: قيمة نصية مُعطاة لخلية رقمية.

## **عوامل حسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة عمل المخطط:

|**العامل**|**المعنى**|**مثال**|
| :- | :- | :- |
|+ (علامة زائد)|جمع أو زائد أحادي|2 + 3|
|- (علامة ناقص)|طرح أو سالب أحادي|2 - 3<br>-3|
|* (نجمة)|ضرب|2 * 3|
|/ (شرطة مائلة)|قسمة|2 / 3|
|% (علامة نسبة)|نسبة مئوية|30%|
|^ (إشارة رفع)|أس|2 ^ 3|

*ملاحظة*: لتغيير ترتيب التقييم، ضع الجزء المراد حسابه أولاً بين أقواس.

## **عوامل مقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عند مقارنة قيمتين بهذه العوامل، تكون النتيجة قيمة منطقية إما *TRUE* أو *FALSE*:

|**العامل**|**المعنى**|**المعنى**|
| :- | :- | :- |
|= (علامة مساواة)|مساوٍ ل|A2 = 3|
|<> (علامة عدم مساواة)|ليس مساويًا ل|A2 <> 3|
|> (علامة أكبر من)|أكبر من|A2 > 3|
|>= (علامة أكبر من أو مساوية)|أكبر من أو مساوي ل|A2 >= 3|
|< (علامة أصغر من)|أصغر من|A2 < 3|
|<= (علامة أصغر من أو مساوية)|أصغر من أو مساوي ل|A2 <= 3|

## **مراجع خلايا بنمط A1**
**مراجع خلايا بنمط A1** تُستخدم في الأوراق التي يكون العمود فيها معرفًا بحرف (مثال: "*A*") والصف معرفًا رقمًا (مثال: "*1*"). يمكن استخدام مراجع الخلايا بنمط A1 بالطريقة التالية:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|$A$2|A2|<p>A$2</p><p>$A2</p>|
|صف|$2:$2|2:2|-|
|عمود|$A:$A|A:A|-|
|نطاق|$A$2:$C$4|A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|

إليك مثالًا على كيفية استخدام مرجع خلية بنمط A1 في الصيغة:

## **مراجع خلايا بنمط R1C1**
**مراجع خلايا بنمط R1C1** تُستخدم في الأوراق التي يكون لكل من الصف والعمود معرفًا رقميًا. يمكن استخدام مراجع خلايا بنمط R1C1 بالطريقة التالية:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف|R2|R[2]|-|
|عمود|C3|C[3]|-|
|نطاق|R2C3:R5C7|R[2]C[3]:R[5]C[7]|R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|

إليك مثالًا على كيفية استخدام مرجع خلية بنمط R1C1 في الصيغة:

## **دوال مسبقة التعريف**
هناك دوال مسبقة التعريف يمكن استخدامها في الصيغ لتبسيط تنفيذها. هذه الدوال تغطي أكثر العمليات شيوعًا، مثل:

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام تاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (صيغة مرجعية)
- LOOKUP (صيغة متجهة)
- MATCH (صيغة متجهة)
- MAX
- SUM
- VLOOKUP

## **الأسئلة المتكررة**

**هل تُدعم ملفات Excel الخارجية كمصدر بيانات لمخطط يحتوي على صيغ؟**

نعم. يدعم Aspose.Slides دفاتر عمل خارجية كمصدر بيانات للمخطط، مما يتيح لك استخدام صيغ من ملف XLSX خارج العرض.

**هل يمكن لصيغ المخطط الإشارة إلى أوراق داخل نفس دفتر العمل بالاسم؟**

نعم. تتبع الصيغ نموذج الإشارة القياسي في Excel، لذا يمكنك الإشارة إلى أوراق أخرى داخل نفس دفتر العمل أو دفتر عمل خارجي. بالنسبة للإشارات الخارجية، يتعين تضمين المسار واسم دفتر العمل باستخدام صيغة Excel.