---
title: تطبيق صيغ ورقة عمل المخطط في العروض التقديمية باستخدام بايثون
linktitle: صيغ ورقة العمل
type: docs
weight: 70
url: /ar/python-net/chart-worksheet-formulas/
keywords:
- مخطط جدول البيانات
- ورقة عمل المخطط
- صيغة المخطط
- صيغة ورقة العمل
- صيغة جدول البيانات
- مصدر البيانات
- ثابت منطقي
- ثابت عددي
- ثابت نصي
- ثابت خطأ
- ثابت حسابي
- عامل مقارنة
- نمط A1
- نمط R1C1
- دالة معرفة مسبقًا
- PowerPoint
- OpenDocument
- عرض تقديمي
- Python
- Aspose.Slides
description: "تطبيق صيغ بنمط Excel في Aspose.Slides للـ Python عبر أوراق عمل المخطط في .NET وتوليد تقارير تلقائيًا عبر ملفات PPT و PPTX و ODP."
---

## **حول صيغة جدول البيانات للمخطط في العرض التقديمي**
**جدول بيانات المخطط** (أو ورقة عمل المخطط) في العرض التقديمي هو مصدر بيانات المخطط. جدول بيانات المخطط يحتوي على بيانات يتم تمثيلها على المخطط بطريقة رسومية. عند إنشاء مخطط في PowerPoint، يتم إنشاء ورقة العمل المرتبطة بهذا المخطط تلقائيًا أيضًا. يتم إنشاء ورقة عمل المخطط لجميع أنواع المخططات: مخطط خطي، مخطط شريطي، مخطط شمسية، مخطط دائري، إلخ. لعرض جدول بيانات المخطط في PowerPoint يجب النقر مزدوجًا على المخطط:

![todo:image_alt_text](chart-worksheet-formulas_1.png)



يحتوي جدول بيانات المخطط على أسماء عناصر المخطط (اسم الفئة: *Category1*، اسم السلسلة) وجدول ببيانات رقمية مناسبة لهذه الفئات والسلاسل. بشكل افتراضي، عندما تنشئ مخططًا جديدًا – يتم ضبط بيانات جدول بيانات المخطط على البيانات الافتراضية. ثم يمكنك تعديل بيانات جدول البيانات في ورقة العمل يدويًا.

عادةً ما يمثل المخطط بيانات معقدة (مثل المحللين الماليين أو العلماء)، حيث الخلايا محسوبة من القيم في خلايا أخرى أو من بيانات ديناميكية أخرى. حساب قيمة الخلية يدويًا وتثبيتها داخل الخلية يجعل من الصعب تغييرها في المستقبل. إذا قمت بتغيير قيمة خلية معينة، سيتوجب تحديث جميع الخلايا التابعة لها أيضًا. علاوة على ذلك، قد تعتمد بيانات الجدول على بيانات جداول أخرى، مما يخلق مخطط بيانات عرض تقديمي معقد يحتاج إلى تحديث سهل ومرن.

**صيغة جدول بيانات المخطط** في العرض التقديمي هي تعبير لحساب وتحديث بيانات جدول بيانات المخطط تلقائيًا. تُعرّف صيغة جدول البيانات منطق حساب البيانات لخلية معينة أو مجموعة خلايا. صيغة جدول البيانات هي صيغة رياضية أو منطقية، تستخدم: مراجع الخلايا، الدوال الرياضية، العوامل المنطقية، العوامل الحسابية، دوال التحويل، الثوابت النصية، إلخ. تُكتب تعريف الصيغة داخل خلية، وهذه الخلية لا تحتوي على قيمة بسيطة. تقوم صيغة جدول البيانات بحساب القيمة وإرجاعها، ثم تُعيّن هذه القيمة للخلية. صيغ جدول بيانات المخططات في العروض التقديمية هي في الواقع نفس صيغ Excel، وتدعم نفس الدوال الافتراضية والعوامل والثوابت لتطبيقها.

في [**Aspose.Slides** ](https://products.aspose.com/slides/python-net/) يُمثَّل جدول بيانات المخطط بـ 
[**Chart.ChartData.ChartDataWorkbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdata/) الخاصية من نوع
[**IChartDataWorkbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdataworkbook/). 
يمكن تعيين صيغة جدول البيانات وتغييرها عبر الخاصية 
[**formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/). 
الوظائف التالية مدعومة للصيغ في Aspose.Slides:

- الثوابت المنطقية
- الثوابت العددية
- الثوابت النصية
- ثوابت الأخطاء
- عوامل حسابية
- عوامل مقارنة
- مراجع خلايا بنمط A1
- مراجع خلايا بنمط R1C1
- الدوال المعرفة مسبقًا



عادةً ما تُخزن الجداول القيم المحسوبة الأخيرة للصيغة. إذا لم يتم تغيير بيانات المخطط بعد تحميل العرض التقديمي – خاصية **IChartDataCell.Value** تُعيد تلك القيم عند القراءة. ولكن إذا تم تغيير بيانات جدول البيانات، عند قراءة خاصية **ChartDataCell.Value** تُرمى الاستثناء **CellUnsupportedDataException** لل صيغ غير المدعومة. يحدث هذا لأنه عندما تُحلل الصيغ بنجاح، يتم تحديد تبعيات الخلايا وتحديد صحة القيم الأخيرة. أما إذا تعذّر تحليل الصيغة، لا يمكن ضمان صحة قيمة الخلية.

## **إضافة صيغة جدول بيانات المخطط إلى العرض التقديمي**
أولاً، أضف مخططًا يحتوي على بعض البيانات النموذجية إلى الشريحة الأولى من عرض تقديمي جديد باستخدام 
[add_chart](https://reference.aspose.com/slides/python-net/aspose.slides/ishapecollection/). 
تُنشأ ورقة عمل المخطط تلقائيًا ويمكن الوصول إليها عبر الخاصية 
[**chart_data_workbook**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdata/):
```py
import aspose.slides.charts as charts
import aspose.slides as slides

with slides.Presentation() as presentation:
    chart = presentation.slides[0].shapes.add_chart(charts.ChartType.CLUSTERED_COLUMN, 150, 150, 500, 300)
    workbook = chart.chart_data.chart_data_workbook
    # ...
```




لنكتب بعض القيم في الخلايا باستخدام الخاصية 
[**value**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) 
من نوع **Object**، مما يعني أنه يمكنك تعيين أي قيمة للخاصية:
```py
    workbook.get_cell(0, "F2").value = -2.5
    workbook.get_cell(0, "G3").value = 6.3
    workbook.get_cell(0, "H4").value = 3
```




الآن لكتابة صيغة إلى الخلية، يمكنك استخدام الخاصية 
[**formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/):
```py
    workbook.get_cell(0, "B2").formula = "F2+G3+H4+1"
```


*ملاحظة*: الخاصية [**IChartDataCell.Formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/) تُستخدم لتعيين مراجع خلايا بنمط A1. 



لتعيين مرجع الخلية [r1c1_formula](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/)، يمكنك استخدام الخاصية [**r1c1_formula**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/ichartdatacell/):
```py
    workbook.get_cell(0, "C2").r1c1_formula = "R[1]C[4]/R[2]C[5]"
```


ثم استخدم طريقة [**calculate_formulas**](https://reference.aspose.com/slides/python-net/aspose.slides.charts/chartdataworkbook/) لحساب جميع الصيغ داخل دفتر العمل وتحديث قيم الخلايا المقابلة:
```py
    workbook.calculate_formulas()
    print(workbook.get_cell(0, "B2").value) # 7.8
    print(workbook.get_cell(0, "C2").value) # 2.1
```



## **الثوابت المنطقية**
يمكنك استخدام الثوابت المنطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:




## **الثوابت العددية**
يمكن استخدام الأرقام بنظام عادي أو علمي لإنشاء صيغ جدول بيانات المخطط:




## **الثوابت النصية**
الثابت النصي (أو الحرفي) هو قيمة محددة تُستخدم كما هي ولا تتغير. قد تكون الثوابت النصية: تواريخ، نصوص، أرقام، إلخ:




## **ثوابت الأخطاء**
أحيانًا لا يمكن حساب النتيجة عبر الصيغة. في هذه الحالة يُظهر رمز الخطأ في الخلية بدلاً من قيمتها. لكل نوع من الأخطاء رمز محدد:

- #DIV/0! - تحاول الصيغة القسمة على صفر.
- #GETTING_DATA - قد يُظهر على خلية بينما لا تزال قيمتها تُحسب.
- #N/A - المعلومات مفقودة أو غير متوفرة. قد تكون الأسباب: الخلايا المستخدمة في الصيغة فارغة، وجود فراغ زائد، خطأ إملائي، إلخ.
- #NAME? - لا يمكن العثور على خلية معينة أو كائن صيغة آخر باسمها. 
- #NULL! - قد يظهر عندما يكون هناك خطأ في الصيغة، مثل:  (,) أو استخدام فراغ بدلاً من النقطتين (:).
- #NUM! - الرقم في الصيغة قد يكون غير صالح، طويل جدًا أو قصير جدًا، إلخ.
- #REF! - مرجع خلية غير صالح.
- #VALUE! - نوع قيمة غير متوقع. على سبيل المثال، قيمة نصية تم تعيينها إلى خلية رقمية.




## **العوامل الحسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة عمل المخطط:

|**العامل**|**المعنى**|**مثال**|
| :- | :- | :- |
|+ (علامة الجمع)|العملية الجمع أو الإشارة الموجبة الأحادية|2 + 3|
|- (علامة الطرح)|العملية الطرح أو النفي|2 - 3<br>-3|
|* (نجمة)|الضرب|2 * 3|
|/ (شرطة مائلة)|القسمة|2 / 3|
|% (نسبة مئوية)|النسبة المئوية|30%|
|^ (سقف)|الرفع للأس|2 ^ 3|

*ملاحظة*: لتغيير ترتيب التقييم، ضع الجزء الذي يُحسب أولاً بين أقواس.



## **العوامل المقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عندما يتم مقارنة قيمتين باستخدام هذه العوامل، تكون النتيجة قيمة منطقية إما *TRUE* أو FALSE:

|**العامل**|**المعنى**|**مثال**|
| :- | :- | :- |
|= (علامة المساواة)|مساوٍ لـ|A2 = 3|
|<> (علامة عدم المساواة)|غير مساوي لـ|A2 <> 3|
|> (علامة أكبر من)|أكبر من|A2 > 3|
|>= (علامة أكبر من أو مساوي)|أكبر من أو مساوي لـ|A2 >= 3|
|< (علامة أصغر من)|أصغر من|A2 < 3|
|<= (علامة أصغر من أو مساوي)|أصغر من أو مساوي لـ|A2 <= 3|

## **مراجع خلايا بنمط A1**
**مراجع خلايا بنمط A1** تُستخدم في أوراق العمل التي تكون فيها الأعمدة محددة بحرف (مثال: "*A*") والصفوف بأرقام (مثال: "*1*"). يمكن استخدام مراجع خلايا نمط A1 بالطريقة التالية:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|$A$2|A2|<p>A$2</p><p>$A2</p>|
|صف|$2:$2|2:2|‑|
|عمود|$A:$A|A:A|‑|
|نطاق|$A$2:$C$4|A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|

إليك مثالًا على استخدام مرجع خلية بنمط A1 في صيغة:




## **مراجع خلايا بنمط R1C1**
**مراجع خلايا بنمط R1C1** تُستخدم في أوراق العمل التي يكون لكل من الصف والعمود معرف رقمي. يمكن استخدام مراجع خلايا نمط R1C1 بالطريقة التالية:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف|R2|R[2]|‑|
|عمود|C3|C[3]|‑|
|نطاق|R2C3:R5C7|R[2]C[3]:R[5]C[7]|R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|

إليك مثالًا على استخدام مرجع خلية بنمط A1 في صيغة:




## **الدوال المعرفة مسبقًا**
هناك دوال معرفة مسبقًا يمكن استخدامها في الصيغ لتبسيط تنفيذها. هذه الدوال تغلف أكثر العمليات شيوعًا، مثل:

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام تاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (نموذج المرجع)
- LOOKUP (نموذج المتجه)
- MATCH (نموذج المتجه)
- MAX
- SUM
- VLOOKUP

## **الأسئلة المتكررة**

**هل تدعم ملفات Excel الخارجية كمصدر بيانات لمخطط يحتوي على صيغ؟**

نعم. يدعم Aspose.Slides ملفات عمل خارجية كمصدر بيانات [المخطط](https://reference.aspose.com/slides/python-net/aspose.slides.charts/chartdatasourcetype/)، مما يتيح لك استخدام صيغ من ملف XLSX خارج العرض التقديمي.

**هل يمكن لصيغ المخطط الإشارة إلى أوراق داخل نفس دفتر العمل عبر اسم الورقة؟**

نعم. تتبع الصيغ نموذج المرجعية القياسي في Excel، لذا يمكنك الإشارة إلى أوراق أخرى داخل نفس دفتر العمل أو دفتر عمل خارجي. للمراجع الخارجية، يجب تضمين المسار واسم دفتر العمل باستخدام تركيب Excel.