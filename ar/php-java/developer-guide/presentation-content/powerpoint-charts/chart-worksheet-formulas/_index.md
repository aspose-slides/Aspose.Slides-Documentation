---
title: "تطبيق صيغ ورقة عمل المخطط في العروض التقديمية باستخدام PHP"
linktitle: "صيغ ورقة العمل"
type: docs
weight: 70
url: /ar/php-java/chart-worksheet-formulas/
keywords:
- "جدول بيانات المخطط"
- "ورقة عمل المخطط"
- "صيغة المخطط"
- "صيغة ورقة العمل"
- "صيغة جدول البيانات"
- "مصدر البيانات"
- "ثابت منطقي"
- "ثابت عددي"
- "ثابت نصي"
- "ثابت خطأ"
- "ثابت حسابي"
- "عامل مقارنة"
- "نمط A1"
- "نمط R1C1"
- "دالة معرفة مسبقًا"
- "PowerPoint"
- "عرض تقديمي"
- "PHP"
- "Aspose.Slides"
description: "تطبيق صيغ بأسلوب Excel في Aspose.Slides للـ PHP عبر أوراق عمل المخططات في Java وتلقائيًا تقارير عبر ملفات PPT و PPTX."
---

## **حول صيغ جدول بيانات المخطط في العروض التقديمية**
**Chart spreadsheet** (أو **chart worksheet**) في العرض التقديمي هو مصدر البيانات للمخطط. يحتوي جدول بيانات المخطط على بيانات يتم تمثيلها على المخطط بصورة رسومية. عندما تنشئ مخططًا في PowerPoint، يتم إنشاء ورقة العمل المرتبطة بهذا المخطط تلقائيًا. تُنشأ ورقة عمل المخطط لجميع أنواع المخططات: مخطط خطي، مخطط شريطي، مخطط شمسية، مخطط دائري، إلخ. لرؤية جدول بيانات المخطط في PowerPoint يجب النقر مزدوجًا على المخطط:

![todo:image_alt_text](chart-worksheet-formulas_1.png)


يحتوي جدول بيانات المخطط على أسماء عناصر المخطط (Category Name: *Category1*، Serie Name) وجدول بالبيانات الرقمية المناسبة لهذه الفئات والسلاسل. بشكل افتراضي، عند إنشاء مخطط جديد – يتم ضبط بيانات جدول بيانات المخطط بالبيانات الافتراضية. ثم يمكنك تعديل بيانات الجدول يدويًا في ورقة العمل.

عادةً ما يمثل المخطط بيانات معقدة (مثل المحللين الماليين أو العلماء)، يحتوي على خلايا تُحسب من قيم خلايا أخرى أو من بيانات ديناميكية أخرى. حساب قيمة الخلية يدويًا وتثبيتها داخل الخلية يجعل تعديلها مستقبلًا صعبًا. إذا قمت بتغيير قيمة خلية معينة، سيتوجب تحديث جميع الخلايا المعتمدة عليها كذلك. علاوة على ذلك، قد تعتمد بيانات الجدول على بيانات جداول أخرى، مما يُنشئ مخطط بيانات عرض تقديمي معقد يحتاج إلى تحديث سهل ومرن.

**صيغة جدول بيانات المخطط** في العرض التقديمي هي تعبير يُحسب تلقائيًا ويُحدّث بيانات جدول بيانات المخطط. تُعرّف صيغة الجدول منطق حساب البيانات لخلية معينة أو مجموعة خلايا. الصيغة هي صيغة رياضية أو منطقية، تستخدم: مراجع خلايا، دوال رياضية، عوامل منطقية، عوامل حسابية، دوال تحويل، ثوابت نصية، إلخ. يُكتب تعريف الصيغة داخل خلية، وهذه الخلية لا تحتوي على قيمة بسيطة. الصيغة تحسب القيمة وتعيدها، ثم تُعيّن هذه القيمة إلى الخلية. صيغ جدول بيانات المخطط في العروض التقديمية هي في الواقع نفس صيغ Excel، وتدعم نفس الدوال الافتراضية والعوامل والثوابت لتنفيذها.

في [**Aspose.Slides**](https://products.aspose.com/slides/php-java/) يُمثَّل جدول بيانات المخطط بـ
[**Chart.getChartData.getChartDataWorkbook**](https://reference.aspose.com/slides/php-java/aspose.slides/IChartData#getChartDataWorkbook--) الخاص بـ
[**IChartDataWorkbook**](https://reference.aspose.com/slides/php-java/aspose.slides/IChartDataWorkbook). يمكن تعيين الصيغة وتغييرها باستخدام
[**IChartDataCell.setFormula**](https://reference.aspose.com/slides/php-java/aspose.slides/IChartDataCell#setFormula-java.lang.String-) . الوظائف التالية مدعومة للصيغ في Aspose.Slides:

- ثوابت منطقية
- ثوابت عددية
- ثوابت نصية
- ثوابت خطأ
- عوامل حسابية
- عوامل مقارنة
- مراجع خلايا بنمط A1
- مراجع خلايا بنمط R1C1
- دوال مُعرَّفة مسبقًا

عادةً ما تخزن جداول البيانات قيم الصيغ المحسوبة الأخيرة. إذا لم تتغيّر بيانات المخطط بعد تحميل العرض، فإن طريقة
[**IChartDataCell.getValue**](https://reference.aspose.com/slides/php-java/aspose.slides/IChartDataCell#getValue--) تُعيد تلك القيم عند القراءة. ولكن إذا تم تعديل بيانات الجدول، فإن قراءة خاصية **ChartDataCell.Value** تُطلق استثناء
[**CellUnsupportedDataException**](https://reference.aspose.com/slides/php-java/aspose.slides/CellUnsupportedDataException) للصيغات غير المدعومة. يحدث هذا لأن الصيغ التي تُحلَّل بنجاح تُحدِّد تبعيات الخلايا وتتحقق من صحة القيم الأخيرة. أما إذا تعذّر تحليل الصيغة، لا يمكن ضمان صحة قيمة الخلية.

## **إضافة صيغة جدول بيانات مخطط إلى عرض تقديمي**
أولًا، أضف مخططًا إلى الشريحة الأولى من عرض تقديمي جديد باستخدام
[IShapeCollection.getShapes.addChart](https://reference.aspose.com/slides/php-java/aspose.slides/IShapeCollection#addChart-int-float-float-float-float-).
يُنشأ ورق العمل للمخطط تلقائيًا ويمكن الوصول إليه عبر
[**Chart.getChartData.getChartDataWorkbook**](https://reference.aspose.com/slides/php-java/aspose.slides/IChartData#getChartDataWorkbook--) :
```php
  $pres = new Presentation();
  try {
    $chart = $pres->getSlides()->get_Item(0)->getShapes()->addChart(ChartType::ClusteredColumn, 150, 150, 500, 300);
    $workbook = $chart->getChartData()->getChartDataWorkbook();
    # ...
  } finally {
    if (!java_is_null($pres)) {
      $pres->dispose();
    }
  }
```


لنكتب بعض القيم في الخلايا باستخدام
[**IChartDataCell.setValue**](https://reference.aspose.com/slides/php-java/aspose.slides/IChartDataCell#setValue-java.lang.Object-) من نوع **Object**، مما يعني أنه يمكنك تعيين أي قيمة إلى الخاصية:
```php
  $workbook->getCell(0, "F2")->setValue(-2.5);
  $workbook->getCell(0, "G3")->setValue(6.3);
  $workbook->getCell(0, "H4")->setValue(3);

```


الآن لكتابة صيغة إلى الخلية، يمكنك استخدام
[**IChartDataCell.setFormula**](https://reference.aspose.com/slides/php-java/aspose.slides/IChartDataCell#setFormula-java.lang.String-) :

*ملاحظة*: تُستعمل طريقة [**IChartDataCell.setFormula**](https://reference.aspose.com/slides/php-java/aspose.slides/IChartDataCell#setFormula-java.lang.String-) لتعيين مراجع خلايا بنمط A1.

لتعيين مرجع خلية بنمط [R1C1Formula](https://reference.aspose.com/slides/php-java/aspose.slides/IChartDataCell#getR1C1Formula--)، يمكنك استخدام طريقة
[**IChartDataCell.setR1C1Formula**](https://reference.aspose.com/slides/php-java/aspose.slides/IChartDataCell#setR1C1Formula-java.lang.String-) :

ثم إذا قرأت القيم من الخلايا B2 و C2، سيتم حسابهما:
```php
  $value1 = $cell1->getValue();// 7.8

  $value2 = $cell2->getValue();// 2.1
```


## **ثوابت منطقية**
يمكنك استخدام ثوابت منطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:
```php
  $workbook->getCell(0, "A2")->setValue(false);
  $cell = $workbook->getCell(0, "B2");
  $cell->setFormula("A2 = TRUE");
  $value = $cell->getValue();// القيمة تحتوي على قيمة منطقية "false"
```


## **ثوابت عددية**
يمكن استخدام الأرقام بنظام عادي أو علمي لإنشاء صيغ جدول بيانات المخطط:
```php
  $workbook->getCell(0, "A2")->setFormula("1 + 0.5");
  $workbook->getCell(0, "B2")->setFormula(".3 * 1E-2");
```


## **ثوابت نصية**
الثابت النصي (أو الحرفي) هو قيمة محددة تُستخدم كما هي ولا تتغير. قد تكون الثوابت النصية: تواريخ، نصوص، أرقام، إلخ:
```php
  $workbook->getCell(0, "A2")->setFormula("\"abc\"");
  $workbook->getCell(0, "B2")->setFormula("\"2/3/2020 12:00\"");

```


## **ثوابت خطأ**
أحيانًا لا يمكن حساب النتيجة بالصيغة. في هذه الحالة يُظهر رمز الخطأ في الخلية بدلًا من قيمتها. لكل نوع من الأخطاء رمز محدد:

- #DIV/0! – تحاول الصيغة القسمة على صفر.
- #GETTING_DATA – قد يظهر في الخلية بينما لا تزال قيمتها تُحسب.
- #N/A – المعلومات مفقودة أو غير متوفرة. قد يكون السبب: الخلايا المستخدمة في الصيغة فارغة، وجود مساحة إضافية، أخطاء إملائية، إلخ.
- #NAME? – لا يمكن العثور على خلية معينة أو كائن صيغة آخر بالاسم.
- #NULL! – قد يظهر عندما يكون هناك خطأ في الصيغة، مثل: (,) أو مساحة بدلاً من النقطتين (:).
- #NUM! – الرقم في الصيغة غير صالح، طويل جدًا أو صغير جدًا، إلخ.
- #REF! – مرجع خلية غير صالح.
- #VALUE! – نوع قيمة غير متوقع. مثال: قيمة نصية وُضعت في خلية رقمية.
```php
  $cell = $workbook->getCell(0, "A2");
  $cell->setFormula("2 / 0");
  $value = $cell->getValue();// القيمة تحتوي على النص "#DIV/0!"
```


## **العوامل الحسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة عمل المخطط:

|**العامل**|**الوظيفة**|**مثال**|
| :- | :- | :- |
|+ (علامة زائد)|جمع أو زائد أحادي|2 + 3|
|- (علامة ناقص)|طرح أو سالب أحادي|2 - 3<br>-3|
|* (علامة نجمة)|ضرب|2 * 3|
|/ (علامة قسمة)|قسمة|2 / 3|
|% (علامة نسبة مئوية)|نسبة مئوية|30%|
|^ (علامة أساندة)|رفع للقوة|2 ^ 3|

*ملاحظة*: لتغيير ترتيب التنفيذ، احطِ الجزء المراد حسابه أولًا بأقواس.

## **العوامل المقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عند مقارنة قيمتين بهذه العوامل، تكون النتيجة قيمة منطقية إما *TRUE* أو FALSE:

|**العامل**|**الوظيفة**|**مثال**|
| :- | :- | :- |
|= (علامة مساواة)|مساوي لـ|A2 = 3|
|<> (علامة عدم مساواة)|ليس مساويًا لـ|A2 <> 3|
|> (علامة أكبر من)|أكبر من|A2 > 3|
|>= (علامة أكبر من أو يساوي)|أكبر من أو يساوي|A2 >= 3|
|< (علامة أصغر من)|أصغر من|A2 < 3|
|<= (علامة أصغر من أو يساوي)|أصغر من أو يساوي|A2 <= 3|

## **مراجع خلايا بنمط A1**
**مراجع خلايا بنمط A1** تُستخدم في أوراق العمل التي يكون فيها العمود معرفًا بحرف (مثال "*A*") والصف معرفًا برقم (مثال "*1*"). يمكن استخدام مراجع A1 بالشكل التالي:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|$A$2|A2|<p>A$2</p><p>$A2</p>|
|صف|$2:$2|2:2|-|
|عمود|$A:$A|A:A|-|
|نطاق|$A$2:$C$4|A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|


إليك مثال على كيفية استخدام مرجع خلية بنمط A1 في صيغة:
```php
  $workbook->getCell(0, "A2")->setFormula("C3 + SUM(F2:H5)");
```


## **مراجع خلايا بنمط R1C1**
**مراجع خلايا بنمط R1C1** تُستخدم في أوراق العمل التي يكون كلا من الصف والعمود معرفين بأرقام. يمكن استخدام مراجع R1C1 بالشكل التالي:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف|R2|R[2]|-|
|عمود|C3|C[3]|-|
|نطاق|R2C3:R5C7|R[2]C[3]:R[5]C[7]|R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|


إليك مثال على كيفية استخدام مرجع خلية بنمط R1C1 في صيغة:
```php
  $workbook->getCell(0, "A2")->setR1C1Formula("R2C4 + SUM(R5C6:R7C9)");
```


## **دوال مُعرَّفة مسبقًا**
هناك دوال مُعرَّفة مسبقًا يمكن استخدامها في الصيغ لتبسيط تنفيذها. تُغلق هذه الدوال أكثر العمليات شيوعًا، مثل:

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام تاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (شكل مرجعي)
- LOOKUP (شكل متجه)
- MATCH (شكل متجه)
- MAX
- SUM
- VLOOKUP

## **الأسئلة الشائعة**

**هل تدعم ملفات Excel الخارجية كمصدر بيانات لمخطط يحتوي على صيغ؟**

نعم. يدعم Aspose.Slides المصنفات الخارجية كمصدر [بيانات المخطط](https://reference.aspose.com/slides/php-java/aspose.slides/chartdatasourcetype/)، مما يتيح لك استخدام صيغ من ملف XLSX خارج العرض التقديمي.

**هل يمكن للصيغ في المخطط الإشارة إلى أوراق داخل نفس المصنف باسم الورقة؟**

نعم. تتبع الصيغ نموذج مراجع Excel القياسي، لذا يمكنك الإشارة إلى أوراق أخرى داخل نفس المصنف أو مصنف خارجي. بالنسبة للمراجع الخارجية، أدرج المسار واسم المصنف باستخدام صيغة Excel.