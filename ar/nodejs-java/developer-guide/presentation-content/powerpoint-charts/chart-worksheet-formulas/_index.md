---
title: صيغ ورقة عمل المخطط
type: docs
weight: 70
url: /ar/nodejs-java/chart-worksheet-formulas/
keywords: "معادلات باوربوينت, صيغ جدول بيانات باوربوينت"
description: "معادلات باوربوينت وصيغ جدول البيانات"
---

## **حول صيغة جدول بيانات المخطط في العرض التقديمي**
**جدول بيانات المخطط** (أو ورقة عمل المخطط) في العرض التقديمي هو مصدر البيانات للمخطط. يحتوي جدول بيانات المخطط على البيانات التي يتم تمثيلها على المخطط بطريقة رسومية. عند إنشاء مخطط في PowerPoint، يتم إنشاء ورقة العمل المرتبطة بهذا المخطط تلقائيًا أيضًا. يتم إنشاء ورقة عمل المخطط لجميع أنواع المخططات: مخطط خطي، مخطط شريطي، مخطط شمسية، مخطط دائري، إلخ. لعرض جدول بيانات المخطط في PowerPoint يجب النقر المزدوج على المخطط:

![todo:image_alt_text](chart-worksheet-formulas_1.png)


يحتوي جدول بيانات المخطط على أسماء عناصر المخطط (اسم الفئة: *Category1*، اسم السلسلة) وجدول ببيانات عددية مناسبة لهذه الفئات والسلاسل. بشكل افتراضي، عند إنشاء مخطط جديد - يتم تعيين بيانات جدول بيانات المخطط بالبيانات الافتراضية. ثم يمكنك تعديل بيانات ورقة العمل يدويًا.

عادةً ما يمثل المخطط بيانات معقدة (مثل المحللين الماليين أو العلماء)، حيث تكون الخلايا محسوبة من قيم خلايا أخرى أو من بيانات ديناميكية أخرى. حساب قيمة الخلية يدويًا وتثبيتها داخل الخلية يجعل من الصعب تغييرها لاحقًا. إذا قمت بتغيير قيمة خلية معينة، سيتعين تحديث كل الخلايا المعتمدة عليها أيضًا. علاوة على ذلك، قد تعتمد بيانات الجدول على بيانات جداول أخرى، مما يخلق مخطط بيانات عرض تقديمي معقد يحتاج إلى تحديث سهل ومرن.

**صيغة جدول بيانات المخطط** في العرض التقديمي هي تعبير لحساب وتحديث بيانات جدول بيانات المخطط تلقائيًا. تعرف صيغة جدول البيانات منطق حساب البيانات لخلية معينة أو مجموعة خلايا. صيغة جدول البيانات هي صيغة رياضية أو منطقية، تستخدم: مراجع الخلايا، دوال رياضية، عوامل منطقية، عوامل حسابية، دوال تحويل، ثوابت نصية، إلخ. تُكتب تعريف الصيغة داخل خلية، وهذه الخلية لا تحتوي على قيمة بسيطة. تحسب صيغة جدول البيانات القيمة وتعيدها، ثم تُعيّن هذه القيمة إلى الخلية. صيغ جدول بيانات المخططات في العروض التقديمية هي في الواقع نفس صيغ إكسل، وتدعم نفس الدوال الافتراضية والعوامل والثوابت لتنفيذها.

في [**Aspose.Slides**](https://products.aspose.com/slides/nodejs-java/) يُمثَّل جدول بيانات المخطط بـ
[**Chart.getChartData.getChartDataWorkbook**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartData#getChartDataWorkbook--) من طريقة
[**ChartDataWorkbook**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartDataWorkbook).
يمكن تعيين صيغة جدول البيانات وتغييرها باستخدام 
[**ChartDataCell.setFormula**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartDataCell#setFormula-java.lang.String-) .
الوظائف التالية مدعومة للصيغ في Aspose.Slides:

- ثوابت منطقية
- ثوابت عددية
- ثوابت نصية
- ثوابت خطأ
- عوامل حسابية
- عوامل مقارنة
- مراجع خلايا بنمط A1
- مراجع خلايا بنمط R1C1
- دوال مُعرَّفة مسبقًا


عادةً ما تخزن جداول البيانات القيم الأخيرة المحسوبة للصيغ. إذا لم تُغيَّر بيانات المخطط بعد تحميل العرض التقديمي - تُعيد طريقة [**ChartDataCell.getValue**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartDataCell#getValue--) هذه القيم عند القراءة. ولكن إذا تم تغيير بيانات جدول البيانات، أثناء قراءة خاصية **ChartDataCell.Value** تُلقى استثناء [**CellUnsupportedDataException**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/CellUnsupportedDataException) للصيغ غير المدعومة. ذلك لأن الصيغ التي تُحلَّل بنجاح تُحدَّد اعتماديات الخلية وتُتحقق صحة القيم الأخيرة. أما إذا لم تُحلَّ الصيغة، فلا يمكن ضمان صحة قيمة الخلية.

## **إضافة صيغة جدول بيانات المخطط إلى العرض التقديمي**
أولاً، أضف مخططًا إلى الشريحة الأولى من عرض تقديمي جديد باستخدام 
[ShapeCollection.getShapes.addChart](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ShapeCollection#addChart-int-float-float-float-float-).
يتم إنشاء ورقة عمل المخطط تلقائيًا ويمكن الوصول إليها باستخدام 
[**Chart.getChartData.getChartDataWorkbook**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartData#getChartDataWorkbook--) :
```javascript
var pres = new aspose.slides.Presentation();
try {
    var chart = pres.getSlides().get_Item(0).getShapes().addChart(aspose.slides.ChartType.ClusteredColumn, 150, 150, 500, 300);
    var workbook = chart.getChartData().getChartDataWorkbook();
    // ...
} finally {
    if (pres != null) {
        pres.dispose();
    }
}
```


لنكتب بعض القيم في الخلايا باستخدام 
[**ChartDataCell.setValue**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartDataCell#setValue-java.lang.Object-) من نوع **Object**، ما يعني أنه يمكنك تعيين أي قيمة لهذه الخاصية:
```javascript
workbook.getCell(0, "F2").setValue(-2.5);
workbook.getCell(0, "G3").setValue(6.3);
workbook.getCell(0, "H4").setValue(3);
```


الآن لكتابة صيغة في الخلية، يمكنك استخدام طريقة 
[**ChartDataCell.setFormula**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartDataCell#setFormula-java.lang.String-) :

*ملاحظة*: طريقة [**ChartDataCell.setFormula**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartDataCell#setFormula-java.lang.String-) تُستخدم لتعيين مراجع خلايا بنمط A1. 

لتعيين مرجع خلية [R1C1Formula](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartDataCell#getR1C1Formula--)، يمكنك استخدام طريقة [**ChartDataCell.setR1C1Formula**](https://reference.aspose.com/slides/nodejs-java/aspose.slides/ChartDataCell#setR1C1Formula-java.lang.String-) :

ثم إذا حاولت قراءة القيم من الخلايا B2 و C2، سيتم حسابها:
```javascript
var value1 = cell1.getValue();// 7.8
var value2 = cell2.getValue();// 2.1
```


## **ثوابت منطقية**
يمكنك استخدام الثوابت المنطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:
```javascript
workbook.getCell(0, "A2").setValue(false);
var cell = workbook.getCell(0, "B2");
cell.setFormula("A2 = TRUE");
var value = cell.getValue();// القيمة تحتوي على منطقية "false"
```


## **ثوابت عددية**
يمكن استخدام الأرقام بصيغ عادية أو علمية لإنشاء صيغة جدول بيانات المخطط:
```javascript
workbook.getCell(0, "A2").setFormula("1 + 0.5");
workbook.getCell(0, "B2").setFormula(".3 * 1E-2");
```


## **ثوابت نصية**
الثابت النصي (أو الحرفي) هو قيمة محددة تُستخدم كما هي ولا تتغير. قد تكون الثوابت النصية: تواريخ، نصوص، أرقام، إلخ:
```javascript
workbook.getCell(0, "A2").setFormula("\"abc\"");
workbook.getCell(0, "B2").setFormula("\"2/3/2020 12:00\"");
```


## **ثوابت خطأ**
أحيانًا لا يمكن حساب النتيجة بواسطة الصيغة. في هذه الحالة يُظهر رمز الخطأ في الخلية بدلًا من قيمتها. لكل نوع من الأخطاء رمز محدد:

- #DIV/0! - تحاول الصيغة القسمة على الصفر.
- #GETTING_DATA - قد يُظهر في الخلية بينما لا يزال قيمتها تُحسب.
- #N/A - المعلومات مفقودة أو غير متاحة. من الأسباب الممكنة: الخلايا المستخدمة في الصيغة فارغة، وجود مسافة إضافية، خطأ إملائي، إلخ.
- #NAME? - لا يمكن العثور على خلية أو كائن صيغ آخر بالاسم المذكور. 
- #NULL! - قد يظهر عند وجود خطأ في الصيغة، مثل:  (,) أو استخدام مسافة بدلًا من نقطتين (:).
- #NUM! - الرقم في الصيغة قد يكون غير صالح، طويل جدًا أو صغير جدًا، إلخ.
- #REF! - إشارة خلية غير صالحة.
- #VALUE! - نوع قيمة غير متوقع. على سبيل المثال، قيمة نصية تُعين لخلية عددية.
```javascript
var cell = workbook.getCell(0, "A2");
cell.setFormula("2 / 0");
var value = cell.getValue();// القيمة تحتوي على السلسلة "#DIV/0!"
```


## **عوامل حسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة عمل المخطط:

|**العامل**|**المعنى**|**مثال**|
| :- | :- | :- |
|+ (علامة الجمع)|جمع أو علامة زائد أحادية|2 + 3|
|- (علامة الطرح)|طرح أو نفي|2 - 3<br>-3|
|* (نجمة)|ضرب|2 * 3|
|/ (شرطة مائلة)|قسمة|2 / 3|
|% (نسبة مئوية)|نسبة مئوية|30%|
|^ (علامة ق caret)|أس|2 ^ 3|

*ملاحظة*: لتغيير ترتيب التقييم، ضع الجزء الذي تريد حسابه أولًا بين أقواس.

## **عوامل مقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عند مقارنة قيمتين باستخدام هذه العوامل، تكون النتيجة قيمة منطقية إما *TRUE* أو *FALSE*:

|**العامل**|**المعنى**|**مثال**|
| :- | :- | :- |
|= (علامة مساواة)|يساوي|A2 = 3|
|<> (علامة عدم مساواة)|لا يساوي|A2 <> 3|
|> (علامة أكبر من)|أكبر من|A2 > 3|
|>= (علامة أكبر من أو يساوي)|أكبر من أو يساوي|A2 >= 3|
|< (علامة أصغر من)|أصغر من|A2 < 3|
|<= (علامة أصغر من أو يساوي)|أصغر من أو يساوي|A2 <= 3|

## **مراجع خلايا بنمط A1**
**مراجع خلايا بنمط A1** تُستخدم في أوراق العمل التي يكون فيها العمود معرفًا بحرف (مثل "*A*") والصف معرفًا برقم (مثل "*1*"). يمكن استخدام مراجع خلايا نمط A1 بالطريقة التالية:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|$A$2|A2|<p>A$2</p><p>$A2</p>|
|صف|$2:$2|2:2|-|
|عمود|$A:$A|A:A|-|
|نطاق|$A$2:$C$4|A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|


إليك مثالًا على كيفية استخدام مرجع خلية بنمط A1 في صيغة:
```javascript
workbook.getCell(0, "A2").setFormula("C3 + SUM(F2:H5)");
```


## **مراجع خلايا بنمط R1C1**
**مراجع خلايا بنمط R1C1** تُستخدم في أوراق العمل التي يكون لكل من الصف والعمود معرفًا رقميًا. يمكن استخدام مراجع خلايا نمط R1C1 بالطريقة التالية:

|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق|نسبي|مختلط|
|خلية|R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف|R2|R[2]|-|
|عمود|C3|C[3]|-|
|نطاق|R2C3:R5C7|R[2]C[3]:R[5]C[7]|R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|


إليك مثالًا على كيفية استخدام مرجع خلية بنمط A1 في صيغة:
```javascript
workbook.getCell(0, "A2").setR1C1Formula("R2C4 + SUM(R5C6:R7C9)");
```


## **دوال مُعرَّفة مسبقًا**
هناك دوال مُعرَّفة مسبقًا يمكن استخدامها في الصيغ لتبسيط تنفيذها. هذه الدوال تغطي العمليات الأكثر شيوعًا، مثل:

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام تاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (نموذج مرجع)
- LOOKUP (نموذج متجه)
- MATCH (نموذج متجه)
- MAX
- SUM
- VLOOKUP

## **الأسئلة المتكررة**

**هل تُدعم ملفات Excel الخارجية كمصدر بيانات لمخطط يحتوي على صيغ؟**

نعم. تدعم Aspose.Slides ملفات عمل خارجية كمصدر [بيانات المخطط](https://reference.aspose.com/slides/nodejs-java/aspose.slides/chartdatasourcetype/)، مما يسمح باستخدام صيغ من ملف XLSX خارج العرض التقديمي.

**هل يمكن لصيغ المخطط الإشارة إلى أوراق داخل نفس ملف العمل باستخدام اسم الورقة؟**

نعم. تتبع الصيغ نموذج الإشارة القياسي في Excel، لذا يمكنك الإشارة إلى أوراق أخرى داخل نفس ملف العمل أو ملف عمل خارجي. بالنسبة للإشارات الخارجية، أدرج المسار واسم ملف العمل باستخدام صيغ Excel.