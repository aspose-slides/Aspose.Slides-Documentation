---
title: صيغ ورقة العمل للرسم البياني
type: docs
weight: 70
url: /ar/cpp/chart-worksheet-formulas/
keywords: "معادلات PowerPoint، صيغ جداول بيانات PowerPoint"
description: "معادلات PowerPoint وصيغ جداول البيانات"
---


## **حول صيغ جداول البيانات للرسم البياني في العرض التقديمي**
**جدول البيانات للرسم البياني** (أو ورقة العمل للرسم البياني) في العرض التقديمي هو مصدر البيانات للرسم البياني. تحتوي ورقة العمل على بيانات، يتم تمثيلها على الرسم البياني بطريقة رسومية. عند إنشاء رسم بياني في PowerPoint، يتم إنشاء ورقة العمل المرتبطة بهذا الرسم البياني تلقائياً أيضاً. يتم إنشاء ورقة العمل لجميع أنواع الرسوم البيانية: الرسم البياني الخطي، الرسم البياني العمودي، الرسم البياني الشمسي، الرسم البياني الدائري، إلخ. لرؤية جدول البيانات للرسم البياني في PowerPoint، يجب عليك النقر نقرًا مزدوجًا على الرسم البياني:

![todo:image_alt_text](chart-worksheet-formulas_1.png)



تحتوي ورقة العمل للرسم البياني على أسماء عناصر الرسم البياني (اسم الفئة: *الفئة1*، اسم السلسلة) وجدول مع بيانات عددية مناسبة لهذه الفئات والسلاسل. بشكل افتراضي، عند إنشاء رسم بياني جديد - يتم تعيين بيانات ورقة العمل للرسم البياني مع البيانات الافتراضية. بعد ذلك، يمكنك تغيير بيانات ورقة العمل يدويًا.

عادةً، يمثل الرسم البياني بيانات معقدة (مثل المحللين الماليين، المحللين العلميين)، تحتوي على خلايا يتم حسابها من القيم في خلايا أخرى أو من بيانات ديناميكية أخرى. يجعل حساب قيمة الخلية يدويًا وتثبيتها في الخلية من الصعب تغييرها في المستقبل. إذا قمت بتغيير قيمة خلية معينة، فستتطلب جميع الخلايا التي تعتمد عليها تحديثًا أيضًا. علاوة على ذلك، قد تعتمد بيانات الجدول على البيانات من جداول أخرى، مما يؤدي إلى إنشاء مخطط بيانات تقديمي معقد يحتاج إلى التحديث بطريقة سهلة ومرنة.

**صيغة ورقة العمل للرسم البياني** في العرض التقديمي هي تعبير لحساب وتحديث بيانات ورقة العمل للرسم البياني تلقائيًا. تحدد صيغة ورقة العمل المنطق الحسابي للبيانات لخلية معينة أو مجموعة من الخلايا. صيغة ورقة العمل هي صيغة رياضية أو صيغة منطقية، والتي تستخدم: مراجع الخلايا، الدوال الرياضية، العوامل المنطقية، العوامل الحسابية، دوال التحويل، الثوابت النصية، إلخ. يتم كتابة تعريف الصيغة في خلية، وتحتوي هذه الخلية على قيمة غير بسيطة. تقوم صيغة ورقة العمل بحساب القيمة وإعادتها، ثم يتم تعيين هذه القيمة إلى الخلية. صيغ ورقة العمل للرسم البياني في العروض التقديمية هي في الواقع نفس صيغ Excel، وهناك نفس الدوال الافتراضية والدوال والثوابت المدعومة لتنفيذها.

في [**Aspose.Slides**](https://products.aspose.com/slides/cpp/) تمثل ورقة العمل للرسم البياني من خلال 
[**ChartData::get_ChartDataWorkbook()**](https://reference.aspose.com/slides/cpp/class/aspose.slides.charts.chart_data#a32097093561723a10df0a57dc91acaea) طريقة من نوع 
[**IChartDataWorkbook**](https://reference.aspose.com/slides/cpp/class/aspose.slides.charts.i_chart_data_workbook). 
يمكن تعيين صيغة ورقة العمل وتغييرها باستخدام 
[**IChartDataCell::set_Formula()**](https://reference.aspose.com/slides/cpp/class/aspose.slides.charts.i_chart_data_cell#a6806c6a40e025e6834c4c5f3af3cf692) الطريقة. 
تتم دعم الوظائف التالية للصيغ في Aspose.Slides:

- الثوابت المنطقية
- الثوابت العددية
- الثوابت النصية
- ثوابت الخطأ
- العوامل الحسابية
- عوامل المقارنة
- مراجع خلايا بأسلوب A1
- مراجع خلايا بأسلوب R1C1
- الدوال المعرفة مسبقًا



عادةً، تقوم جداول البيانات بتخزين آخر قيم صيغ محسوبة. إذا لم تتغير بيانات الرسم البياني بعد تحميل العرض التقديمي - ستعيد طريقة **IChartDataCell.get_Value()** تلك القيم أثناء القراءة. ولكن، إذا تم تغيير بيانات ورقة العمل، أثناء القراءة، فإن طريقة **ChartDataCell.get_Value()** ترمي استثناء **CellUnsupportedDataException** لصيغ غير المدعومة. وذلك لأن مراجع الخلية تُحدد عندما يتم تحليل الصيغ بنجاح وتحديد صحة القيم الأخيرة. ولكن، إذا لم يكن بالإمكان تحليل الصيغة، فلا يمكن ضمان صحة قيمة الخلية.


## **إضافة صيغة ورقة العمل للرسم البياني إلى العرض التقديمي**
أولاً، أضف رسمًا بيانيًا إلى الشريحة الأولى من عرض تقديمي جديد باستخدام 
[IShapeCollection::AddChart()](https://reference.aspose.com/slides/cpp/class/aspose.slides.i_shape_collection#a2cd4d47fc5c536012ee15b3a69486374). 
يتم إنشاء ورقة العمل للرسم البياني تلقائيًا ويمكن الوصول إليها باستخدام 
[**ChartData::get_ChartDataWorkbook()**](https://reference.aspose.com/slides/cpp/class/aspose.slides.charts.chart_data#a32097093561723a10df0a57dc91acaea) الطريقة:



``` cpp
auto presentation = System::MakeObject<Presentation>();
    
auto chart = presentation->get_Slides()->idx_get(0)->get_Shapes()->AddChart(ChartType::ClusteredColumn, 150.0f, 150.0f, 500.0f, 300.0f);
auto workbook = chart->get_ChartData()->get_ChartDataWorkbook();

// ...
```



دعنا نكتب بعض القيم في الخلايا باستخدام 
[**IChartDataCell.set_Value()**](https://reference.aspose.com/slides/cpp/class/aspose.slides.charts.i_chart_data_cell#ad85809f520195e09225abae9002635ec) الطريقة 
من نوع **Object**، مما يعني أنه يمكنك تمرير أي قيمة إلى الطريقة:



``` cpp
workbook->GetCell(0, u"F2")->set_Value(System::ObjectExt::Box<double>(-2.5));
workbook->GetCell(0, u"G3")->set_Value(System::ObjectExt::Box<double>(6.3));
workbook->GetCell(0, u"H4")->set_Value(System::ObjectExt::Box<int32_t>(3));
```



الآن لكتابة صيغة في الخلية، يمكنك استخدام 
[**IChartDataCell::set_Formula()**](https://reference.aspose.com/slides/cpp/class/aspose.slides.charts.i_chart_data_cell#a6806c6a40e025e6834c4c5f3af3cf692) الطريقة:





*ملاحظة*: [**IChartDataCell::set_Formula()**](https://reference.aspose.com/slides/cpp/class/aspose.slides.charts.i_chart_data_cell#a6806c6a40e025e6834c4c5f3af3cf692) تُستخدم لتعيين مراجع خلايا بأسلوب A1. 



لتعيين مرجع خلية R1C1Formula، يمكنك استخدام [**IChartDataCell::set_R1C1Formula()**](https://reference.aspose.com/slides/cpp/class/aspose.slides.charts.i_chart_data_cell#a47f5825dd38d0dddb11ecc3a43d388c7) الطريقة:





ثم، إذا حاولت قراءة القيم من الخلايا B2 و C2، سيتم حسابها:



``` cpp
auto value1 = cell1->get_Value(); // 7.8
auto value2 = cell2->get_Value(); // 2.1
```


## **الثوابت المنطقية**
يمكنك استخدام الثوابت المنطقية مثل *FALSE* و *TRUE* في صيغ الخلايا:




## **الثوابت العددية**
يمكن استخدام الأرقام في الصيغ العادية أو العلمية لإنشاء صيغة جدول بيانات الرسم البياني:




## **الثوابت النصية**
الثابت النصي (أو الأدبي) هو قيمة محددة تُستخدم كما هي ولا تتغير. قد تكون الثوابت النصية: تواريخ، نصوص، أرقام، إلخ:




## **ثوابت الخطأ**
في بعض الأحيان، لا يمكن حساب النتيجة بواسطة الصيغة. في تلك الحالة، يتم عرض رمز الخطأ في الخلية بدلاً من قيمتها. كل نوع من أنواع الخطأ له رمز محدد:

- #DIV/0! - تحاول الصيغة القسمة على صفر.
- #GETTING_DATA - قد يظهر على الخلية، بينما لا تزال قيمتها قيد الحساب.
- #N/A - المعلومات مفقودة أو غير متاحة. بعض الأسباب يمكن أن تكون: الخلايا المستخدمة في الصيغة فارغة، أو وجود حرف فراغ إضافي، أو خطأ في الكتابة، إلخ.
- #NAME? - لا يمكن العثور على خلية معينة أو كائنات صيغة أخرى بنفس اسمها. 
- #NULL! - قد يظهر عندما يكون هناك خطأ في الصيغة، مثل:  (,) أو استخدام حرف فراغ بدلاً من نقطتين (:).
- #NUM! - قد تكون الأرقام في الصيغة غير صالحة، طويلة جدًا أو صغيرة جدًا، إلخ.
- #REF! - مرجع خلية غير صالح.
- #VALUE! - نوع قيمة غير متوقعة. على سبيل المثال، قيمة نصية تم تعيينها إلى خلية عددية.




## **العوامل الحسابية**
يمكنك استخدام جميع العوامل الحسابية في صيغ ورقة العمل للرسم البياني:



|**العامل** |**المعنى** |**مثال**|
| :- | :- | :- |
|+ (علامة الجمع) |الجمع أو الجمع الأحادي|2 + 3|
|- (علامة الطرح) |الطرح أو السالب |2 - 3<br>-3|
|* (نجمة)|الضرب |2 * 3|
|/ (شرطة مائلة)|القسمة |2 / 3|
|% (علامة النسبة) |النسبة المئوية |30%|
|^ (علامة القارئة) |الأس |2 ^ 3|


*ملاحظة*: لتغيير ترتيب التقييم، قم بإحاطة الجزء من الصيغة الذي يجب حسابه أولاً بالأقواس.


## **عوامل المقارنة**
يمكنك مقارنة قيم الخلايا باستخدام عوامل المقارنة. عندما تتم مقارنة قيمتين باستخدام هذه العوامل، تكون النتيجة قيمة منطقية إما *TRUE* أو FALSE:



|**العامل** |**المعنى** |**المعنى** |
| :- | :- | :- |
|= (علامة المساواة) |يساوي |A2 = 3|
|<> (علامة عدم المساواة) |لا يساوي|A2 <> 3|
|> (علامة أكبر من) |أكبر من|A2 > 3|
|>= (علامة أكبر من أو يساوي)|أكبر من أو يساوي|A2 >= 3|
|< (علامة أصغر من)|أصغر من|A2 < 3|
|<= (علامة أصغر من أو يساوي)|أصغر من أو يساوي|A2 <= 3|

## **مراجع خلايا بأسلوب A1**
**مراجع خلايا بأسلوب A1** تُستخدم لجداول البيانات، حيث تحتوي العمود على مُعرّف حرفي (مثل "*A*") والصف له مُعرّف عددي (مثل "*1*"). يمكن استخدام مراجع خلايا بأسلوب A1 بالطريقة التالية:



|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق |نسبي |مختلط|
|خلية |$A$2 |A2|<p>A$2</p><p>$A2</p>|
|صف |$2:$2 |2:2 |-|
|عمود |$A:$A |A:A |-|
|نطاق |$A$2:$C$4 |A2:C4|<p>$A$2:C4</p><p>A$2:$C4</p>|


إليك مثال على كيفية استخدام مرجع خلية بأسلوب A1 في صيغة:




## **مراجع خلايا بأسلوب R1C1**
**مراجع خلايا بأسلوب R1C1** تُستخدم لجداول البيانات، حيث يحتوي كل من الصف والعمود على مُعرّف عددي. يمكن استخدام مراجع خلايا بأسلوب R1C1 بالطريقة التالية:



|**مرجع الخلية**|**مثال**|||
| :- | :- | :- | :- |
||مطلق |نسبي |مختلط|
|خلية |R2C3|R[2]C[3]|R2C[3]<br>R[2]C3|
|صف |R2|R[2]|-|
|عمود |C3|C[3]|-|
|نطاق |R2C3:R5C7|R[2]C[3]:R[5]C[7] |R2C3:R[5]C[7]<br>R[2]C3:R5C[7]|


إليك مثال على كيفية استخدام مرجع خلية بأسلوب A1 في صيغة:




## **الدوال المعرفة مسبقًا**
هناك دوال معرفة مسبقًا، يمكن استخدامها في الصيغ لتبسيط تنفيذها. تقوم هذه الدوال بتغليف العمليات الأكثر استخدامًا، مثل: 

- ABS
- AVERAGE
- CEILING
- CHOOSE
- CONCAT
- CONCATENATE
- DATE (نظام التاريخ 1900)
- DAYS
- FIND
- FINDB
- IF
- INDEX (شكل مرجعي)
- LOOKUP (شكل متجه)
- MATCH (شكل متجه)
- MAX
- SUM
- VLOOKUP